import{j as s}from"./jsx-runtime-u17CrQMm.js";import{u as ce,h as W,H as T}from"./useQuery-BvsAiDXI.js";import{u as C,Q as me,a as ue}from"./QueryClientProvider-BMCchIl4.js";import{r as d}from"./iframe-CdLyeb6m.js";import{E as pe}from"./index-De2_V-S8.js";import{P as le}from"./index-D26oWmff.js";import{B as E}from"./index-BKtDPDeF.js";import{e as de,u as h,g as ge,s as he,A as g,i as ye,h as fe,j as ve}from"./index-9i9U3BBu.js";import{u as I}from"./useErrorModal-CP7S3eTA.js";import{G as _e}from"./index-D3ymXUWS.js";import{M as xe}from"./index-COAzQ30d.js";import{G as je}from"./index-BAY1fr7a.js";import{G as Me}from"./index-BHdO_yBZ.js";import{G as Ce}from"./index-De3Iad7K.js";import"./index-Cy5lP2GC.js";import"./index-B5DpYhLs.js";import{L as Ie}from"./index-BrOBrL7F.js";import"./index-Dzz_JUmW.js";import"./index-BisnGRS6.js";import"./index-KgQFBhLH.js";import"./index-uyzdwiiI.js";import"./index-ClPCH5Uf.js";import"./index-Cbe7hXxv.js";import"./index-B5__YZAs.js";import"./index-pNyubZWQ.js";import"./index-BBGZHdYo.js";import{u as Se,M as be}from"./chunk-JMJ3UQ3L-BD8XmwrQ.js";import{c as Ge}from"./createLucideIcon-B-yWAdHL.js";import"./preload-helper-PPVm8Dsz.js";import"./index-BKyx4Nv4.js";import"./Combination-CUcpsVkp.js";import"./index-BvwbJulw.js";import"./index-5yzgPyqn.js";import"./x-Db6nCcWx.js";import"./mail-D05UbAYj.js";import"./check-DIBib_it.js";import"./user-plus-CiCQlcuf.js";import"./search-Cfoz267O.js";import"./index-lYk79lf5.js";import"./heart-BH1imaKI.js";const Ee=[["path",{d:"M13.22 2.416a2 2 0 0 0-2.511.057l-7 5.999A2 2 0 0 0 3 10v9a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7.354",key:"5phn05"}],["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M15 6h6",key:"1jlkvy"}],["path",{d:"M18 3v6",key:"x1uolp"}]],ke=Ge("house-plus",Ee),Ne=d.createContext(null);function P({value:a,children:o}){return s.jsx(Ne.Provider,{value:a,children:o})}P.__docgenInfo={description:"",methods:[],displayName:"SessionUserProvider",props:{value:{required:!0,tsType:{name:"AppSessionUser"},description:""},children:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""}}};const we="_footerNote_e0z94_21",qe={footerNote:we},y=["groups"],Ue=()=>ce({queryKey:y,queryFn:de}),We=()=>{const a=C();return h({mutationFn:o=>ge({name:o}),onSuccess:async()=>{await a.invalidateQueries({queryKey:y})}})},Te=()=>{const[a,o]=d.useState(""),{showError:i,closeError:n,getModalMessage:r}=I(),t=h({mutationFn:({groupId:u,email:l})=>he({groupId:u,email:l}),onError:u=>{if(u instanceof g&&u.status===422){o(u.message),n();return}const l=u instanceof g?u.status:void 0,S=u instanceof Error&&u.message?u.message:"æ¤œç´¢ã«å¤±æ•—ã—ã¾ã—ãŸ";o(""),i({title:"æ¤œç´¢ã‚¨ãƒ©ãƒ¼",message:l?r(l):S})},onSuccess:()=>{o(""),n()}}),c=()=>{o("")};return{...t,errorMessage:a,clearErrorMessage:c,resetSearchResult:()=>{t.reset(),c()}}},Pe=()=>{const a=C(),{showError:o,closeError:i,getModalMessage:n}=I();return h({mutationFn:({groupId:r,userId:t})=>ye({groupId:r,user_id:t}),onSuccess:async()=>{await a.invalidateQueries({queryKey:y}),i()},onError:r=>{const t=r instanceof g?r.status:void 0,c=r instanceof Error&&r.message?r.message:"ãƒ¦ãƒ¼ã‚¶ãƒ¼æ‹›å¾…ã«å¤±æ•—ã—ã¾ã—ãŸ";o({title:"æ‹›å¾…ã‚¨ãƒ©ãƒ¼",message:t?n(t):c})}})},Re=a=>{const o=C(),{showError:i,closeError:n,getModalMessage:r}=I();return h({mutationFn:({groupId:t})=>fe({groupId:t}),onSuccess:async(t,c)=>{await o.invalidateQueries({queryKey:y}),n(),a?.onSuccess?.(c.groupId)},onError:t=>{const c=t instanceof g?t.status:void 0,f=t instanceof Error&&t.message?t.message:"æ‹›å¾…ã®æ‰¿èªã«å¤±æ•—ã—ã¾ã—ãŸ";i({title:"æ‹›å¾…æ‰¿èªã‚¨ãƒ©ãƒ¼",message:c?r(c):f})}})},Ae=()=>{const a=C(),{showError:o,closeError:i,getModalMessage:n}=I();return h({mutationFn:({groupId:r})=>ve({groupId:r}),onSuccess:async()=>{await a.invalidateQueries({queryKey:y}),i()},onError:r=>{const t=r instanceof g?r.status:void 0,c=r instanceof Error&&r.message?r.message:"æ‹›å¾…ã®æ‹’å¦ã«å¤±æ•—ã—ã¾ã—ãŸ";o({title:"æ‹›å¾…æ‹’å¦ã‚¨ãƒ©ãƒ¼",message:t?n(t):c})}})},De="_message_1lkur_1",Oe={message:De};function R({open:a,groupName:o,onOpenChange:i,onConfirm:n,onCancel:r,isSubmitting:t=!1}){return s.jsx(xe,{open:a,onOpenChange:i,title:"æ‹›å¾…ã‚’æ‹’å¦ã—ã¾ã™",footer:s.jsxs(s.Fragment,{children:[s.jsx(E,{type:"button",variant:"outline",size:"md",radius:"lg",onClick:r,disabled:t,children:"ã‚­ãƒ£ãƒ³ã‚»ãƒ«"}),s.jsx(E,{type:"button",variant:"primary",size:"md",radius:"lg",onClick:n,disabled:t,children:"æ‹’å¦ã™ã‚‹"})]}),children:s.jsxs("p",{className:Oe.message,children:["ã€Œ",o??"ã‚°ãƒ«ãƒ¼ãƒ—","ã€ã¸ã®æ‹›å¾…ã‚’æœ¬å½“ã«æ‹’å¦ã—ã¾ã™ã‹ï¼Ÿ"]})})}R.__docgenInfo={description:"",methods:[],displayName:"GroupDenyModal",props:{open:{required:!0,tsType:{name:"boolean"},description:""},groupName:{required:!1,tsType:{name:"string"},description:""},onOpenChange:{required:!0,tsType:{name:"signature",type:"function",raw:"(open: boolean) => void",signature:{arguments:[{type:{name:"boolean"},name:"open"}],return:{name:"void"}}},description:""},onConfirm:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},onCancel:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},isSubmitting:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}}}};const Qe="_groupsContent_b1rrt_1",Fe="_sectionHeader_b1rrt_7",Le="_emptyCard_b1rrt_50",He="_emptyEmoji_b1rrt_60",$e="_emptyTitle_b1rrt_65",ze="_emptyDescription_b1rrt_72",Ke="_helperText_b1rrt_79",Be="_list_b1rrt_86",Ye="_loadingWrapper_b1rrt_91",p={groupsContent:Qe,sectionHeader:Fe,emptyCard:Le,emptyEmoji:He,emptyTitle:$e,emptyDescription:ze,helperText:Ke,list:Be,loadingWrapper:Ye};function A(){const a=Se(),[o,i]=d.useState(!1),[n,r]=d.useState(null),[t,c]=d.useState(null),{data:f,isLoading:u,isError:l}=Ue(),{mutateAsync:S,isPending:O}=We(),{mutateAsync:Q,isPending:F}=Pe(),{mutateAsync:L,isPending:H}=Re({onSuccess:e=>{const m=b.find(ie=>ie.id===e)?.name??e;a(`/groups/${e}`,{state:{groupName:m}})}}),{mutateAsync:$,isPending:N}=Ae(),{mutateAsync:z,isPending:K,data:B,errorMessage:Y,clearErrorMessage:J,resetSearchResult:w}=Te(),V=async e=>{try{await S(e),i(!1)}catch(m){console.error(m)}},b=f?.groups??[],q=b.filter(e=>e.is_invited),U=b.filter(e=>!e.is_invited),X=U.length>0,Z=(e,m)=>{r({id:e,name:m}),w()},ee=()=>{r(null),w()},se=(e,m)=>{c({id:e,name:m})},G=()=>{c(null)},te=async e=>{if(n)try{await z({groupId:n.id,email:e})}catch(m){console.error(m)}},re=async e=>{if(n)try{await Q({groupId:n.id,userId:e})}catch(m){console.error(m)}},oe=async e=>{try{await L({groupId:e})}catch(m){console.error(m)}},ae=async()=>{if(t)try{await $({groupId:t.id}),G()}catch(e){console.error(e)}},ne=()=>u?s.jsx("div",{className:p.loadingWrapper,children:s.jsx(Ie,{size:"md",ariaLabel:"ã‚°ãƒ«ãƒ¼ãƒ—ã‚’èª­ã¿è¾¼ã¿ä¸­"})}):l?s.jsx("p",{className:p.helperText,children:"ã‚°ãƒ«ãƒ¼ãƒ—ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸ"}):!X&&q.length===0?s.jsxs("div",{className:p.emptyCard,children:[s.jsx("div",{className:p.emptyEmoji,"aria-hidden":"true",children:"ðŸ "}),s.jsx("p",{className:p.emptyTitle,children:"ã¾ã ã‚°ãƒ«ãƒ¼ãƒ—ãŒã‚ã‚Šã¾ã›ã‚“"}),s.jsxs("p",{className:p.emptyDescription,children:["å®¶æ—ã‚„å‹äººã¨ã‚°ãƒ«ãƒ¼ãƒ—ã‚’ä½œã£ã¦",s.jsx("br",{}),"å®¶äº‹ã‚’å…±æœ‰ã—ã¾ã—ã‚‡ã†ï¼"]})]}):s.jsxs("div",{className:p.list,children:[q.map(e=>s.jsx(Me,{groupName:e.name,inviterName:void 0,disabled:H||N,onAccept:()=>{oe(e.id)},onDecline:()=>{se(e.id,e.name)}},`invite-${e.id}`)),U.map(e=>s.jsx(je,{name:e.name,memberCount:e.member_count,invitedCount:e.invited_count,onInviteClick:()=>{Z(e.id,e.name)},onOpenClick:()=>{a(`/groups/${e.id}`,{state:{groupName:e.name}})}},e.id))]});return s.jsxs(le,{children:[s.jsxs("section",{className:p.groupsContent,"aria-labelledby":"groups-heading",children:[s.jsxs("div",{className:p.sectionHeader,children:[s.jsx("h2",{id:"groups-heading",children:"ã‚ãªãŸã®ã‚°ãƒ«ãƒ¼ãƒ—"}),s.jsx(E,{variant:"primary",radius:"pill",size:"md",fullWidth:!0,icon:s.jsx(ke,{"aria-hidden":!0,size:18}),onClick:()=>{i(!0)},children:"æ–°è¦ä½œæˆ"})]}),ne(),s.jsx(_e,{open:o,onOpenChange:i,onSubmit:e=>{V(e)},isSubmitting:O})]}),s.jsx(Ce,{open:!!n,onOpenChange:e=>{e||ee()},groupName:n?.name??"ã‚°ãƒ«ãƒ¼ãƒ—å",onSearch:e=>{te(e)},isSearching:K,isInviting:F,searchResults:B?.users??[],searchError:Y,onClearSearchError:J,onInvite:e=>{re(e.id)}}),s.jsx(R,{open:!!t,groupName:t?.name,onOpenChange:e=>{e||G()},onCancel:G,onConfirm:()=>{ae()},isSubmitting:N})]})}A.__docgenInfo={description:"",methods:[],displayName:"GroupsSection"};function k(){return s.jsxs(s.Fragment,{children:[s.jsx(A,{}),s.jsx("p",{className:qe.footerNote,children:"ã•ã‚ã€ä»Šé€±ã‚‚é ‘å¼µã‚Šã¾ã—ã‚‡ã†ï¼ âœ¨"})]})}k.__docgenInfo={description:"",methods:[],displayName:"UserPage"};const Je={groups:[{id:"group-1",name:"æ°¸äº•å®¶",image:null,member_count:1,invited_count:0,is_invited:!1},{id:"group-2",name:"æµ…äº•å®¶",image:null,member_count:3,invited_count:1,is_invited:!1},{id:"group-3",name:"ã‚·ã‚§ã‚¢ãƒã‚¦ã‚¹æ¡œ",image:"https://images.unsplash.com/photo-1505693416388-ac5ce068fe85?auto=format&fit=crop&w=200&h=200&q=80",member_count:5,invited_count:2,is_invited:!1}]},Os={component:k,parameters:{layout:"fullscreen",msw:{handlers:[W.get(/\/api\/groups$/,()=>T.json(Je))]}},argTypes:{user:{control:!1}},decorators:[(a,o)=>{const i=new me({defaultOptions:{queries:{refetchOnWindowFocus:!1}}});return s.jsx(be,{initialEntries:["/users/mock-user"],children:s.jsx(P,{value:o.args.user,children:s.jsx(ue,{client:i,children:s.jsx(pe,{children:s.jsx(a,{})})})})})}],render:()=>s.jsx(k,{})},D={id:"mock-user",name:"å±±ç”° èŠ±å­",email:"hanako@example.com",image:null},Ve={id:"mock-user-image",name:"å±±ç”° èŠ±å­",email:"hanako@example.com",image:"https://images.unsplash.com/photo-1524504388940-b1c1722653e1?auto=format&fit=facearea&w=200&h=200&q=80"},Xe={id:"mock-user-large-image",name:"å±±ç”° å¤§è¼”",email:"daisuke@example.com",image:"https://images.unsplash.com/photo-1521572163474-6864f9cf17ab?auto=format&w=1200&h=1200&q=80"},Ze={id:"mock-user-small-image",name:"å±±ç”° å°æ˜¥",email:"koharu@example.com",image:"https://images.unsplash.com/photo-1521572163474-6864f9cf17ab?auto=format&w=60&h=60&q=80"},v={args:{user:D}},_={args:{user:Ve}},x={args:{user:Xe}},j={args:{user:Ze}},M={args:{user:D},parameters:{msw:{handlers:[W.get(/\/api\/groups$/,()=>T.json({groups:[]}))]}}};v.parameters={...v.parameters,docs:{...v.parameters?.docs,source:{originalSource:`{
  args: {
    user: mockUserWithoutImage
  }
}`,...v.parameters?.docs?.source}}};_.parameters={..._.parameters,docs:{..._.parameters?.docs,source:{originalSource:`{
  args: {
    user: mockUserWithImage
  }
}`,..._.parameters?.docs?.source}}};x.parameters={...x.parameters,docs:{...x.parameters?.docs,source:{originalSource:`{
  args: {
    user: mockUserWithLargeImage
  }
}`,...x.parameters?.docs?.source}}};j.parameters={...j.parameters,docs:{...j.parameters?.docs,source:{originalSource:`{
  args: {
    user: mockUserWithSmallImage
  }
}`,...j.parameters?.docs?.source}}};M.parameters={...M.parameters,docs:{...M.parameters?.docs,source:{originalSource:`{
  args: {
    user: mockUserWithoutImage
  },
  parameters: {
    msw: {
      handlers: [http.get(/\\/api\\/groups$/, () => HttpResponse.json({
        groups: []
      }))]
    }
  }
}`,...M.parameters?.docs?.source}}};const Qs=["WithoutImage","WithImage","WithLargeImage","WithSmallImage","NoGroups"];export{M as NoGroups,_ as WithImage,x as WithLargeImage,j as WithSmallImage,v as WithoutImage,Qs as __namedExportsOrder,Os as default};
