import{j as e}from"./jsx-runtime-u17CrQMm.js";import{r as l}from"./iframe-M9O5mXHc.js";import{g as O,G as D}from"./index-BweyK0Nx.js";import{U as y}from"./index-BdIhwI-g.js";import{H as U}from"./index-x_GeCMp0.js";import{C as H}from"./index-CITLG3uC.js";import{A as x,m as _,L as P}from"./index-BHeo3YQp.js";import{c as V}from"./createLucideIcon-B_rlYIdZ.js";import{u as j}from"./QueryClientProvider-DvqYujE2.js";import{u as v,b as G,A as N,d as z}from"./index-BAhPNSu6.js";import{u as b}from"./useErrorModal-vbdt33B6.js";const Q=[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}],["path",{d:"M14.8 7.5a1.84 1.84 0 0 0-2.6 0l-.2.3-.3-.3a1.84 1.84 0 1 0-2.4 2.8L12 13l2.7-2.7c.9-.9.8-2.1.1-2.8",key:"1blaws"}]],K=V("message-square-heart",Q),Oe=s=>["groups",s,"chores"],I=(s,r)=>["groups",s,"beatings",r],Y="_gratitudeList_11cv8_1",$="_gratitudeAccordion_11cv8_7",F="_gratitudeSummaryIcon_11cv8_13",J="_gratitudeSummary_11cv8_13",W="_gratitudeSummaryText_11cv8_38",X="_gratitudeExtraList_11cv8_43",Z="_gratitudeAccordionBody_11cv8_49",ee="_gratitudeItem_11cv8_53",te="_gratitudeHeader_11cv8_64",se="_gratitudeBadge_11cv8_70",ae="_gratitudeName_11cv8_88",re="_gratitudeMain_11cv8_95",ie="_gratitudeDescribe_11cv8_103",n={gratitudeList:Y,gratitudeAccordion:$,gratitudeSummaryIcon:F,gratitudeSummary:J,gratitudeSummaryText:W,gratitudeExtraList:X,gratitudeAccordionBody:Z,gratitudeItem:ee,gratitudeHeader:te,gratitudeBadge:se,gratitudeName:ae,gratitudeMain:re,gratitudeDescribe:ie};function f({message:s}){return e.jsxs("div",{className:n.gratitudeItem,children:[e.jsxs("div",{className:n.gratitudeHeader,children:[e.jsx(y,{name:s.userName,imageUrl:s.userImageUrl,size:"sm",tone:"orange",badge:e.jsx("span",{className:n.gratitudeBadge,"aria-hidden":!0,children:e.jsx(U,{size:"sm"})})}),e.jsx("p",{className:n.gratitudeName,children:s.userName})]}),e.jsx("p",{className:n.gratitudeMain,children:s.mainMessage}),s.describeMessage?e.jsx("p",{className:n.gratitudeDescribe,children:s.describeMessage}):null]})}function M({messages:s=[]}){const r=s[0],o=s.slice(1),[d,t]=l.useState(!1),[a,i]=l.useState(!1);return s.length===0?null:e.jsxs("div",{className:n.gratitudeList,"aria-label":"感謝メッセージ",children:[e.jsx(f,{message:r}),o.length>0?e.jsxs("details",{className:n.gratitudeAccordion,open:a,children:[e.jsxs("summary",{className:n.gratitudeSummary,onClick:u=>{if(u.preventDefault(),d){t(!1);return}t(!0),i(!0)},children:[e.jsx("span",{className:n.gratitudeSummaryIcon,"aria-hidden":!0,children:e.jsx(H,{size:16})}),e.jsxs("span",{className:n.gratitudeSummaryText,children:["他",o.length,"件の感謝を見る"]})]}),e.jsx(x,{initial:!1,onExitComplete:()=>{i(!1)},children:d?e.jsx(_.div,{className:n.gratitudeAccordionBody,initial:{height:0,opacity:0},animate:{height:"auto",opacity:1,transitionDuration:"0.3",transition:{ease:"easeIn"}},exit:{height:0,opacity:0,transitionDuration:"0.3",transition:{ease:"easeOut"}},children:e.jsx("div",{className:n.gratitudeExtraList,children:o.map(u=>e.jsx(f,{message:u},u.id))})}):null})]}):null]})}M.__docgenInfo={description:"",methods:[],displayName:"BeatingMessages",props:{messages:{required:!1,tsType:{name:"unknown"},description:"",defaultValue:{value:"[]",computed:!1}}}};const ne="_button_1y88b_1",oe="_icon_1y88b_22",ce="_count_1y88b_28",ue="_thanksRibbon_1y88b_33",m={button:ne,icon:oe,count:ce,thanksRibbon:ue},de={solid:{fill:"currentColor",stroke:"currentColor"},outline:{fill:"none",stroke:"currentColor"}};function T({messagedByMe:s,commentCount:r,onClick:o}){const t=de[s?"solid":"outline"],[a,i]=l.useState(!1),[u,g]=l.useState(0);return e.jsxs(_.button,{type:"button",className:m.button,"aria-label":"メッセージを送る","aria-pressed":s,whileTap:{scale:.8},onClick:()=>{if(s){g(p=>p+1),i(!0);return}o()},children:[e.jsx("span",{className:m.icon,"aria-hidden":!0,children:e.jsx(K,{size:20,...t})}),r>0?e.jsx("span",{className:m.count,children:r}):null,e.jsx(x,{children:a?e.jsx(_.span,{className:m.thanksRibbon,"aria-hidden":!0,initial:{opacity:0,y:8,scale:.96},animate:{opacity:[0,1,1,0],y:[8,0,-4,-8],scale:[.96,1.3,1.3,.98]},transition:{duration:1.4,ease:"easeOut"},onAnimationComplete:()=>{i(!1)},children:"いつも感謝をありがとう！"},u):null})]})}T.__docgenInfo={description:"",methods:[],displayName:"MessageReaction",props:{messagedByMe:{required:!0,tsType:{name:"boolean"},description:""},commentCount:{required:!0,tsType:{name:"number"},description:""},onClick:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""}}};const le=()=>{const s=j(),{showError:r,closeError:o,getModalMessage:d}=b();return v({mutationFn:({groupId:t,beatingId:a})=>G({groupId:t,beatingId:a}),onSuccess:async(t,a)=>{await s.invalidateQueries({queryKey:I(a.groupId,a.date)}),o()},onError:t=>{const a=t instanceof N?t.status:void 0,i=t instanceof Error&&t.message?t.message:"いいねの送信に失敗しました";r({title:"いいねエラー",message:a?d(a):i})}})},me=()=>{const s=j(),{showError:r,closeError:o,getModalMessage:d}=b();return v({mutationFn:({groupId:t,beatingId:a,mainMessage:i,descriptionMessage:u})=>z({groupId:t,beatingId:a,main_message:i,description_message:u.length>0?u:null}),onSuccess:async(t,a)=>{await s.invalidateQueries({queryKey:I(a.groupId,a.date)}),o()},onError:t=>{const a=t instanceof N?t.status:void 0,i=t instanceof Error&&t.message?t.message:"感謝メッセージの送信に失敗しました";r({title:"感謝メッセージ投稿エラー",message:a?d(a):i})}})},ge="_card_1mjof_1",pe="_header_1mjof_14",_e="_choreIcon_1mjof_20",he="_headerBody_1mjof_31",fe="_choreName_1mjof_38",ye="_reactions_1mjof_45",xe="_divider_1mjof_53",je="_footer_1mjof_59",ve="_user_1mjof_65",Ne="_userText_1mjof_71",be="_userName_1mjof_77",Ie="_userRole_1mjof_84",c={card:ge,header:pe,choreIcon:_e,headerBody:he,choreName:fe,reactions:ye,divider:xe,footer:je,user:ve,userText:Ne,userName:be,userRole:Ie};function Me({groupId:s,beatingId:r,date:o,choreIconCode:d,choreName:t,userName:a,userImageUrl:i,likeCount:u=0,likedByMe:g=!1,messagedByMe:p=!1,commentCount:k=0,userRoleLabel:C="討伐者",messages:S=[]}){const{mutate:B,isPending:q}=le(),{mutateAsync:E,isPending:R}=me(),[L,h]=l.useState(!1);return e.jsxs("article",{className:c.card,"aria-label":`${a}が${t}を討伐`,children:[e.jsxs("div",{className:c.header,children:[e.jsx("div",{className:c.choreIcon,"aria-hidden":!0,children:O(d)}),e.jsxs("div",{className:c.headerBody,children:[e.jsx("p",{className:c.choreName,children:t}),e.jsxs("div",{className:c.reactions,children:[e.jsx(P,{likedByMe:g,likeCount:u,isLiking:q,onLike:()=>{B({groupId:s,beatingId:r,date:o})}}),e.jsx(T,{messagedByMe:p,commentCount:k,onClick:()=>{h(!0)}})]})]})]}),e.jsx(M,{messages:S}),e.jsx("div",{className:c.divider,"aria-hidden":!0}),e.jsx("div",{className:c.footer,children:e.jsxs("div",{className:c.user,children:[e.jsx(y,{name:a,imageUrl:i,size:"md",tone:"purple"}),e.jsxs("div",{className:c.userText,children:[e.jsx("p",{className:c.userName,children:a}),e.jsx("p",{className:c.userRole,children:C})]})]})}),e.jsx(D,{open:L,onOpenChange:h,choreIconCode:d,choreName:t,userName:a,isSubmitting:R,onSubmit:async({mainMessage:A,descriptionMessage:w})=>{await E({groupId:s,beatingId:r,date:o,mainMessage:A,descriptionMessage:w})}})]})}Me.__docgenInfo={description:"",methods:[],displayName:"BeatingCard",props:{groupId:{required:!0,tsType:{name:"string"},description:""},beatingId:{required:!0,tsType:{name:"number"},description:""},date:{required:!0,tsType:{name:"string"},description:""},choreIconCode:{required:!0,tsType:{name:"unknown"},description:""},choreName:{required:!0,tsType:{name:"string"},description:""},userName:{required:!0,tsType:{name:"string"},description:""},userImageUrl:{required:!1,tsType:{name:"union",raw:"string | null",elements:[{name:"string"},{name:"null"}]},description:""},likeCount:{required:!1,tsType:{name:"number"},description:"",defaultValue:{value:"0",computed:!1}},likedByMe:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},messagedByMe:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},commentCount:{required:!1,tsType:{name:"number"},description:"",defaultValue:{value:"0",computed:!1}},userRoleLabel:{required:!1,tsType:{name:"string"},description:"",defaultValue:{value:'"討伐者"',computed:!1}},messages:{required:!1,tsType:{name:"unknown"},description:"",defaultValue:{value:"[]",computed:!1}}}};export{Me as B,Oe as G,I as a};
