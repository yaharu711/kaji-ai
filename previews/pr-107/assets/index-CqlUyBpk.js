import{j as e}from"./jsx-runtime-u17CrQMm.js";import{r as l}from"./iframe-CbR8zjLh.js";import{g as O,G as D}from"./index-CCbv5wKm.js";import{U as y}from"./index-Vur8oChw.js";import"./index-D26oWmff.js";import"./index-4TD7kgHm.js";import"./index-ClqQeNIL.js";import"./index-BKtDPDeF.js";import"./index-De6OYTau.js";import"./index-DiC-WU9F.js";import"./index-E1MPPeGY.js";import"./index-kPqHomOF.js";import"./index-D3wAgL9v.js";import"./index-DBg_G1Nz.js";import"./index-xoiHztkD.js";import{C as U}from"./index-D5UJjyMs.js";import"./index-CfRPaHwE.js";import{H as V}from"./index-DFrGIBjC.js";import{B as P}from"./index-nwPEcs-M.js";import{A as x,m as _,L as z}from"./index-DgRZ1GeP.js";import{c as G}from"./createLucideIcon-DFpuGLqs.js";import{u as j}from"./QueryClientProvider-BC9t5K1l.js";import{u as v,b as Q,A as N,d as K}from"./index-DlFENKry.js";import{u as b}from"./useErrorModal-vbcHkW1C.js";const Y=[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}],["path",{d:"M14.8 7.5a1.84 1.84 0 0 0-2.6 0l-.2.3-.3-.3a1.84 1.84 0 1 0-2.4 2.8L12 13l2.7-2.7c.9-.9.8-2.1.1-2.8",key:"1blaws"}]],$=G("message-square-heart",Y),Ze=t=>["groups",t,"chores"],k=(t,i)=>["groups",t,"beatings",i],F="_gratitudeList_1kpvs_1",J="_gratitudeAccordion_1kpvs_7",W="_gratitudeSummaryIcon_1kpvs_13",X="_gratitudeSummary_1kpvs_13",Z="_gratitudeSummaryText_1kpvs_38",ee="_gratitudeExtraList_1kpvs_43",te="_gratitudeAccordionBody_1kpvs_49",se="_gratitudeItem_1kpvs_53",ae="_gratitudeHeader_1kpvs_64",re="_gratitudeHeaderText_1kpvs_70",ie="_gratitudeBadge_1kpvs_76",ne="_gratitudeName_1kpvs_91",oe="_gratitudeMain_1kpvs_98",de="_gratitudeDescribe_1kpvs_106",r={gratitudeList:F,gratitudeAccordion:J,gratitudeSummaryIcon:W,gratitudeSummary:X,gratitudeSummaryText:Z,gratitudeExtraList:ee,gratitudeAccordionBody:te,gratitudeItem:se,gratitudeHeader:ae,gratitudeHeaderText:re,gratitudeBadge:ie,gratitudeName:ne,gratitudeMain:oe,gratitudeDescribe:de};function f({message:t}){return e.jsxs("div",{className:r.gratitudeItem,children:[e.jsxs("div",{className:r.gratitudeHeader,children:[e.jsx(y,{name:t.userName,imageUrl:t.userImageUrl,size:"md",tone:"orange",badge:e.jsx("span",{className:r.gratitudeBadge,"aria-hidden":!0,children:e.jsx(V,{size:"md"})})}),e.jsxs("div",{className:r.gratitudeHeaderText,children:[t.isMyBeating?e.jsx(P,{size:"sm",radius:"pill",variant:"accent",children:"討伐者"}):null,e.jsx("p",{className:r.gratitudeName,children:t.userName})]})]}),t.isMyBeating?null:e.jsx("p",{className:r.gratitudeMain,children:t.mainMessage}),t.describeMessage?e.jsx("p",{className:r.gratitudeDescribe,children:t.describeMessage}):null]})}function M({messages:t=[]}){const i=t[0],o=t.slice(1),[c,s]=l.useState(!1),[a,n]=l.useState(!1);return t.length===0?null:e.jsxs("div",{className:r.gratitudeList,"aria-label":"感謝メッセージ",children:[e.jsx(f,{message:i}),o.length>0?e.jsxs("details",{className:r.gratitudeAccordion,open:a,children:[e.jsxs("summary",{className:r.gratitudeSummary,onClick:u=>{if(u.preventDefault(),c){s(!1);return}s(!0),n(!0)},children:[e.jsx("span",{className:r.gratitudeSummaryIcon,"aria-hidden":!0,children:e.jsx(U,{size:16})}),e.jsxs("span",{className:r.gratitudeSummaryText,children:["他",o.length,"件の感謝を見る"]})]}),e.jsx(x,{initial:!1,onExitComplete:()=>{n(!1)},children:c?e.jsx(_.div,{className:r.gratitudeAccordionBody,initial:{height:0,opacity:0},animate:{height:"auto",opacity:1,transitionDuration:"0.3",transition:{ease:"easeIn"}},exit:{height:0,opacity:0,transitionDuration:"0.3",transition:{ease:"easeOut"}},children:e.jsx("div",{className:r.gratitudeExtraList,children:o.map(u=>e.jsx(f,{message:u},u.id))})}):null})]}):null]})}M.__docgenInfo={description:"",methods:[],displayName:"BeatingMessages",props:{messages:{required:!1,tsType:{name:"unknown"},description:"",defaultValue:{value:"[]",computed:!1}}}};const ue="_button_1y88b_1",ce="_icon_1y88b_22",le="_count_1y88b_28",me="_thanksRibbon_1y88b_33",m={button:ue,icon:ce,count:le,thanksRibbon:me},pe={solid:{fill:"currentColor",stroke:"currentColor"},outline:{fill:"none",stroke:"currentColor"}};function T({messagedByMe:t,commentCount:i,onClick:o}){const s=pe[t?"solid":"outline"],[a,n]=l.useState(!1),[u,p]=l.useState(0);return e.jsxs(_.button,{type:"button",className:m.button,"aria-label":"メッセージを送る","aria-pressed":t,whileTap:{scale:.8},onClick:()=>{if(t){p(g=>g+1),n(!0);return}o()},children:[e.jsx("span",{className:m.icon,"aria-hidden":!0,children:e.jsx($,{size:20,...s})}),i>0?e.jsx("span",{className:m.count,children:i}):null,e.jsx(x,{children:a?e.jsx(_.span,{className:m.thanksRibbon,"aria-hidden":!0,initial:{opacity:0,y:8,scale:.96},animate:{opacity:[0,1,1,0],y:[8,0,-4,-8],scale:[.96,1.3,1.3,.98]},transition:{duration:1.4,ease:"easeOut"},onAnimationComplete:()=>{n(!1)},children:"いつも感謝をありがとう！"},u):null})]})}T.__docgenInfo={description:"",methods:[],displayName:"MessageReaction",props:{messagedByMe:{required:!0,tsType:{name:"boolean"},description:""},commentCount:{required:!0,tsType:{name:"number"},description:""},onClick:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""}}};const ge=()=>{const t=j(),{showError:i,closeError:o,getModalMessage:c}=b();return v({mutationFn:({groupId:s,beatingId:a})=>Q({groupId:s,beatingId:a}),onSuccess:async(s,a)=>{await t.invalidateQueries({queryKey:k(a.groupId,a.date)}),o()},onError:s=>{const a=s instanceof N?s.status:void 0,n=s instanceof Error&&s.message?s.message:"いいねの送信に失敗しました";i({title:"いいねエラー",message:a?c(a):n})}})},_e=()=>{const t=j(),{showError:i,closeError:o,getModalMessage:c}=b();return v({mutationFn:({groupId:s,beatingId:a,mainMessage:n,descriptionMessage:u})=>K({groupId:s,beatingId:a,main_message:n,description_message:u.length>0?u:null}),onSuccess:async(s,a)=>{await t.invalidateQueries({queryKey:k(a.groupId,a.date)}),o()},onError:s=>{const a=s instanceof N?s.status:void 0,n=s instanceof Error&&s.message?s.message:"感謝メッセージの送信に失敗しました";i({title:"感謝メッセージ投稿エラー",message:a?c(a):n})}})},he="_card_1mjof_1",fe="_header_1mjof_14",ye="_choreIcon_1mjof_20",xe="_headerBody_1mjof_31",je="_choreName_1mjof_38",ve="_reactions_1mjof_45",Ne="_divider_1mjof_53",be="_footer_1mjof_59",ke="_user_1mjof_65",Me="_userText_1mjof_71",Te="_userName_1mjof_77",Ie="_userRole_1mjof_84",d={card:he,header:fe,choreIcon:ye,headerBody:xe,choreName:je,reactions:ve,divider:Ne,footer:be,user:ke,userText:Me,userName:Te,userRole:Ie};function Be({groupId:t,beatingId:i,date:o,choreIconCode:c,choreName:s,userName:a,userImageUrl:n,likeCount:u=0,likedByMe:p=!1,messagedByMe:g=!1,commentCount:I=0,userRoleLabel:B="討伐者",isMyBeating:C=!1,messages:S=[]}){const{mutate:q,isPending:E}=ge(),{mutateAsync:R,isPending:L}=_e(),[A,h]=l.useState(!1);return e.jsxs("article",{className:d.card,"aria-label":`${a}が${s}を討伐`,children:[e.jsxs("div",{className:d.header,children:[e.jsx("div",{className:d.choreIcon,"aria-hidden":!0,children:O(c)}),e.jsxs("div",{className:d.headerBody,children:[e.jsx("p",{className:d.choreName,children:s}),e.jsxs("div",{className:d.reactions,children:[e.jsx(z,{likedByMe:p,likeCount:u,isLiking:E,onLike:()=>{q({groupId:t,beatingId:i,date:o})}}),e.jsx(T,{messagedByMe:g,commentCount:I,onClick:()=>{h(!0)}})]})]})]}),e.jsx(M,{messages:S}),e.jsx("div",{className:d.divider,"aria-hidden":!0}),e.jsx("div",{className:d.footer,children:e.jsxs("div",{className:d.user,children:[e.jsx(y,{name:a,imageUrl:n,size:"md",tone:"purple"}),e.jsxs("div",{className:d.userText,children:[e.jsx("p",{className:d.userName,children:a}),e.jsx("p",{className:d.userRole,children:B})]})]})}),e.jsx(D,{open:A,onOpenChange:h,choreIconCode:c,choreName:s,userName:a,isMyBeating:C,isSubmitting:L,onSubmit:async({mainMessage:w,descriptionMessage:H})=>{await R({groupId:t,beatingId:i,date:o,mainMessage:w,descriptionMessage:H})}})]})}Be.__docgenInfo={description:"",methods:[],displayName:"BeatingCard",props:{groupId:{required:!0,tsType:{name:"string"},description:""},beatingId:{required:!0,tsType:{name:"number"},description:""},date:{required:!0,tsType:{name:"string"},description:""},choreIconCode:{required:!0,tsType:{name:"unknown"},description:""},choreName:{required:!0,tsType:{name:"string"},description:""},userName:{required:!0,tsType:{name:"string"},description:""},userImageUrl:{required:!1,tsType:{name:"union",raw:"string | null",elements:[{name:"string"},{name:"null"}]},description:""},likeCount:{required:!1,tsType:{name:"number"},description:"",defaultValue:{value:"0",computed:!1}},likedByMe:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},messagedByMe:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},commentCount:{required:!1,tsType:{name:"number"},description:"",defaultValue:{value:"0",computed:!1}},userRoleLabel:{required:!1,tsType:{name:"string"},description:"",defaultValue:{value:'"討伐者"',computed:!1}},isMyBeating:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},messages:{required:!1,tsType:{name:"unknown"},description:"",defaultValue:{value:"[]",computed:!1}}}};export{Be as B,Ze as G,k as a};
