import{j as e}from"./jsx-runtime-u17CrQMm.js";import{r as l}from"./iframe-4ganmSLo.js";import{g as O,G as D}from"./index-DJasH7wZ.js";import{U as y}from"./index-CWwl-CpG.js";import"./index-D26oWmff.js";import"./index-sSjlW9Ak.js";import"./index-CiAqrXrz.js";import"./index-BKtDPDeF.js";import"./index-QV8yLdKF.js";import"./index-DvZAtJLV.js";import"./index-DDW9ylOk.js";import"./index-DkhCOBkr.js";import"./index-B3LYhDOD.js";import"./index-oUs1lSwv.js";import"./index-B_zWGwif.js";import{C as U}from"./index-B-ZC5RS0.js";import"./index-BU67Lb0H.js";import{H as z}from"./index-DN_eKUht.js";import{B as x}from"./index-BBGZHdYo.js";import{A as j,m as _,L as P}from"./index-CPLPvddz.js";import{c as V}from"./createLucideIcon-CeqnCMew.js";import{u as v}from"./QueryClientProvider-BGOnmKfl.js";import{u as N,b as G,A as b,d as Q}from"./index-BpEujyaa.js";import{u as k}from"./useErrorModal-sZs2WXkx.js";const K=[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}],["path",{d:"M14.8 7.5a1.84 1.84 0 0 0-2.6 0l-.2.3-.3-.3a1.84 1.84 0 1 0-2.4 2.8L12 13l2.7-2.7c.9-.9.8-2.1.1-2.8",key:"1blaws"}]],Y=V("message-square-heart",K),We=t=>["groups",t,"chores"],M=(t,r)=>["groups",t,"beatings",r],$="_gratitudeList_1kpvs_1",F="_gratitudeAccordion_1kpvs_7",J="_gratitudeSummaryIcon_1kpvs_13",W="_gratitudeSummary_1kpvs_13",X="_gratitudeSummaryText_1kpvs_38",Z="_gratitudeExtraList_1kpvs_43",ee="_gratitudeAccordionBody_1kpvs_49",te="_gratitudeItem_1kpvs_53",se="_gratitudeHeader_1kpvs_64",ae="_gratitudeHeaderText_1kpvs_70",ie="_gratitudeBadge_1kpvs_76",re="_gratitudeName_1kpvs_91",ne="_gratitudeMain_1kpvs_98",oe="_gratitudeDescribe_1kpvs_106",i={gratitudeList:$,gratitudeAccordion:F,gratitudeSummaryIcon:J,gratitudeSummary:W,gratitudeSummaryText:X,gratitudeExtraList:Z,gratitudeAccordionBody:ee,gratitudeItem:te,gratitudeHeader:se,gratitudeHeaderText:ae,gratitudeBadge:ie,gratitudeName:re,gratitudeMain:ne,gratitudeDescribe:oe};function f({message:t}){return e.jsxs("div",{className:i.gratitudeItem,children:[e.jsxs("div",{className:i.gratitudeHeader,children:[e.jsx(y,{name:t.userName,imageUrl:t.userImageUrl,size:"md",tone:"orange",badge:e.jsx("span",{className:i.gratitudeBadge,"aria-hidden":!0,children:e.jsx(z,{size:"md"})})}),e.jsxs("div",{className:i.gratitudeHeaderText,children:[t.isMyBeating?e.jsx(x,{size:"sm",radius:"pill",variant:"accent",children:"討伐者"}):null,e.jsx("p",{className:i.gratitudeName,children:t.userName})]})]}),t.isMyBeating?null:e.jsx("p",{className:i.gratitudeMain,children:t.mainMessage}),t.describeMessage?e.jsx("p",{className:i.gratitudeDescribe,children:t.describeMessage}):null]})}function T({messages:t=[]}){const r=t[0],o=t.slice(1),[u,s]=l.useState(!1),[a,n]=l.useState(!1);return t.length===0?null:e.jsxs("div",{className:i.gratitudeList,"aria-label":"感謝メッセージ",children:[e.jsx(f,{message:r}),o.length>0?e.jsxs("details",{className:i.gratitudeAccordion,open:a,children:[e.jsxs("summary",{className:i.gratitudeSummary,onClick:d=>{if(d.preventDefault(),u){s(!1);return}s(!0),n(!0)},children:[e.jsx("span",{className:i.gratitudeSummaryIcon,"aria-hidden":!0,children:e.jsx(U,{size:16})}),e.jsxs("span",{className:i.gratitudeSummaryText,children:["他",o.length,"件の感謝を見る"]})]}),e.jsx(j,{initial:!1,onExitComplete:()=>{n(!1)},children:u?e.jsx(_.div,{className:i.gratitudeAccordionBody,initial:{height:0,opacity:0},animate:{height:"auto",opacity:1,transitionDuration:"0.3",transition:{ease:"easeIn"}},exit:{height:0,opacity:0,transitionDuration:"0.3",transition:{ease:"easeOut"}},children:e.jsx("div",{className:i.gratitudeExtraList,children:o.map(d=>e.jsx(f,{message:d},d.id))})}):null})]}):null]})}T.__docgenInfo={description:"",methods:[],displayName:"BeatingMessages",props:{messages:{required:!1,tsType:{name:"unknown"},description:"",defaultValue:{value:"[]",computed:!1}}}};const de="_button_1y88b_1",ce="_icon_1y88b_22",ue="_count_1y88b_28",le="_thanksRibbon_1y88b_33",m={button:de,icon:ce,count:ue,thanksRibbon:le},me={solid:{fill:"currentColor",stroke:"currentColor"},outline:{fill:"none",stroke:"currentColor"}};function I({messagedByMe:t,commentCount:r,onClick:o}){const s=me[t?"solid":"outline"],[a,n]=l.useState(!1),[d,p]=l.useState(0);return e.jsxs(_.button,{type:"button",className:m.button,"aria-label":"メッセージを送る","aria-pressed":t,whileTap:{scale:.8},onClick:()=>{if(t){p(g=>g+1),n(!0);return}o()},children:[e.jsx("span",{className:m.icon,"aria-hidden":!0,children:e.jsx(Y,{size:20,...s})}),r>0?e.jsx("span",{className:m.count,children:r}):null,e.jsx(j,{children:a?e.jsx(_.span,{className:m.thanksRibbon,"aria-hidden":!0,initial:{opacity:0,y:8,scale:.96},animate:{opacity:[0,1,1,0],y:[8,0,-4,-8],scale:[.96,1.3,1.3,.98]},transition:{duration:1.4,ease:"easeOut"},onAnimationComplete:()=>{n(!1)},children:"いつも感謝をありがとう！"},d):null})]})}I.__docgenInfo={description:"",methods:[],displayName:"MessageReaction",props:{messagedByMe:{required:!0,tsType:{name:"boolean"},description:""},commentCount:{required:!0,tsType:{name:"number"},description:""},onClick:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""}}};const pe=()=>{const t=v(),{showError:r,closeError:o,getModalMessage:u}=k();return N({mutationFn:({groupId:s,beatingId:a})=>G({groupId:s,beatingId:a}),onSuccess:async(s,a)=>{await t.invalidateQueries({queryKey:M(a.groupId,a.date)}),o()},onError:s=>{const a=s instanceof b?s.status:void 0,n=s instanceof Error&&s.message?s.message:"いいねの送信に失敗しました";r({title:"いいねエラー",message:a?u(a):n})}})},ge=()=>{const t=v(),{showError:r,closeError:o,getModalMessage:u}=k();return N({mutationFn:({groupId:s,beatingId:a,mainMessage:n,descriptionMessage:d})=>Q({groupId:s,beatingId:a,main_message:n,description_message:d.length>0?d:null}),onSuccess:async(s,a)=>{await t.invalidateQueries({queryKey:M(a.groupId,a.date)}),o()},onError:s=>{const a=s instanceof b?s.status:void 0,n=s instanceof Error&&s.message?s.message:"感謝メッセージの送信に失敗しました";r({title:"感謝メッセージ投稿エラー",message:a?u(a):n})}})},_e="_card_1mjof_1",he="_header_1mjof_14",fe="_choreIcon_1mjof_20",ye="_headerBody_1mjof_31",xe="_choreName_1mjof_38",je="_reactions_1mjof_45",ve="_divider_1mjof_53",Ne="_footer_1mjof_59",be="_user_1mjof_65",ke="_userText_1mjof_71",Me="_userName_1mjof_77",c={card:_e,header:he,choreIcon:fe,headerBody:ye,choreName:xe,reactions:je,divider:ve,footer:Ne,user:be,userText:ke,userName:Me};function Te({groupId:t,beatingId:r,date:o,choreIconCode:u,choreName:s,userName:a,userImageUrl:n,likeCount:d=0,likedByMe:p=!1,messagedByMe:g=!1,commentCount:B=0,isMyBeating:C=!1,messages:S=[]}){const{mutate:q,isPending:E}=pe(),{mutateAsync:L,isPending:A}=ge(),[R,h]=l.useState(!1);return e.jsxs("article",{className:c.card,"aria-label":`${a}が${s}を討伐`,children:[e.jsxs("div",{className:c.header,children:[e.jsx("div",{className:c.choreIcon,"aria-hidden":!0,children:O(u)}),e.jsxs("div",{className:c.headerBody,children:[e.jsx("p",{className:c.choreName,children:s}),e.jsxs("div",{className:c.reactions,children:[e.jsx(P,{likedByMe:p,likeCount:d,isLiking:E,onLike:()=>{q({groupId:t,beatingId:r,date:o})}}),e.jsx(I,{messagedByMe:g,commentCount:B,onClick:()=>{h(!0)}})]})]})]}),e.jsx(T,{messages:S}),e.jsx("div",{className:c.divider,"aria-hidden":!0}),e.jsx("div",{className:c.footer,children:e.jsxs("div",{className:c.user,children:[e.jsx(y,{name:a,imageUrl:n,size:"md",tone:"purple"}),e.jsxs("div",{className:c.userText,children:[e.jsx(x,{size:"sm",radius:"pill",variant:"accent",children:"討伐者"}),e.jsx("p",{className:c.userName,children:a})]})]})}),e.jsx(D,{open:R,onOpenChange:h,choreIconCode:u,choreName:s,userName:a,isMyBeating:C,isSubmitting:A,onSubmit:async({mainMessage:w,descriptionMessage:H})=>{await L({groupId:t,beatingId:r,date:o,mainMessage:w,descriptionMessage:H})}})]})}Te.__docgenInfo={description:"",methods:[],displayName:"BeatingCard",props:{groupId:{required:!0,tsType:{name:"string"},description:""},beatingId:{required:!0,tsType:{name:"number"},description:""},date:{required:!0,tsType:{name:"string"},description:""},choreIconCode:{required:!0,tsType:{name:"unknown"},description:""},choreName:{required:!0,tsType:{name:"string"},description:""},userName:{required:!0,tsType:{name:"string"},description:""},userImageUrl:{required:!1,tsType:{name:"union",raw:"string | null",elements:[{name:"string"},{name:"null"}]},description:""},likeCount:{required:!1,tsType:{name:"number"},description:"",defaultValue:{value:"0",computed:!1}},likedByMe:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},messagedByMe:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},commentCount:{required:!1,tsType:{name:"number"},description:"",defaultValue:{value:"0",computed:!1}},userRoleLabel:{required:!1,tsType:{name:"string"},description:""},isMyBeating:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},messages:{required:!1,tsType:{name:"unknown"},description:"",defaultValue:{value:"[]",computed:!1}}}};export{Te as B,We as G,M as a};
