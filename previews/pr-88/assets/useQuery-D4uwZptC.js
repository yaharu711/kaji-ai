import{s as De,c as Ie,R as Ue,d as H,t as Fe,g as Me,i as Qe,n as _,a as _e,r as I}from"./iframe-B8NlnD31.js";import{R as qe,r as $,n as A,k as D,l as pe,m as Q,t as ye,o as ke,C as J,p as x,q as ve,v as Le,S as W,w as Y,x as B,y as z,z as X,B as L,D as me,E as Ne,F as je,G as He,M as $e,H as Z,I as ge,J as ee,K as te,L as Be,N as se,O as re,P as be,u as ze}from"./index-BuJqQ2rW.js";import"./jsx-runtime-u17CrQMm.js";function Ke(e,t){return e.toLowerCase()===t.toLowerCase()}function We(e){return e<300?"#69AB32":e<400?"#F0BB4B":"#E95F5D"}async function Ge(e){const s=await e.clone().text();return{url:new URL(e.url),method:e.method,headers:Object.fromEntries(e.headers.entries()),body:s}}const{message:Ve}=De;async function Je(e){const t=e.clone(),s=await t.text(),r=t.status||200,i=t.statusText||Ve[r]||"OK";return{status:r,statusText:i,headers:Object.fromEntries(t.headers.entries()),body:s}}function Ye(e){for(var t=[],s=0;s<e.length;){var r=e[s];if(r==="*"||r==="+"||r==="?"){t.push({type:"MODIFIER",index:s,value:e[s++]});continue}if(r==="\\"){t.push({type:"ESCAPED_CHAR",index:s++,value:e[s++]});continue}if(r==="{"){t.push({type:"OPEN",index:s,value:e[s++]});continue}if(r==="}"){t.push({type:"CLOSE",index:s,value:e[s++]});continue}if(r===":"){for(var i="",a=s+1;a<e.length;){var n=e.charCodeAt(a);if(n>=48&&n<=57||n>=65&&n<=90||n>=97&&n<=122||n===95){i+=e[a++];continue}break}if(!i)throw new TypeError("Missing parameter name at ".concat(s));t.push({type:"NAME",index:s,value:i}),s=a;continue}if(r==="("){var o=1,v="",a=s+1;if(e[a]==="?")throw new TypeError('Pattern cannot start with "?" at '.concat(a));for(;a<e.length;){if(e[a]==="\\"){v+=e[a++]+e[a++];continue}if(e[a]===")"){if(o--,o===0){a++;break}}else if(e[a]==="("&&(o++,e[a+1]!=="?"))throw new TypeError("Capturing groups are not allowed at ".concat(a));v+=e[a++]}if(o)throw new TypeError("Unbalanced pattern at ".concat(s));if(!v)throw new TypeError("Missing pattern at ".concat(s));t.push({type:"PATTERN",index:s,value:v}),s=a;continue}t.push({type:"CHAR",index:s,value:e[s++]})}return t.push({type:"END",index:s,value:""}),t}function Xe(e,t){t===void 0&&(t={});for(var s=Ye(e),r=t.prefixes,i=r===void 0?"./":r,a=t.delimiter,n=a===void 0?"/#?":a,o=[],v=0,l=0,h="",m=function(O){if(l<s.length&&s[l].type===O)return s[l++].value},p=function(O){var C=m(O);if(C!==void 0)return C;var T=s[l],j=T.type,Ae=T.index;throw new TypeError("Unexpected ".concat(j," at ").concat(Ae,", expected ").concat(O))},c=function(){for(var O="",C;C=m("CHAR")||m("ESCAPED_CHAR");)O+=C;return O},f=function(O){for(var C=0,T=n;C<T.length;C++){var j=T[C];if(O.indexOf(j)>-1)return!0}return!1},u=function(O){var C=o[o.length-1],T=O||(C&&typeof C=="string"?C:"");if(C&&!T)throw new TypeError('Must have text between two parameters, missing text after "'.concat(C.name,'"'));return!T||f(T)?"[^".concat(M(n),"]+?"):"(?:(?!".concat(M(T),")[^").concat(M(n),"])+?")};l<s.length;){var g=m("CHAR"),R=m("NAME"),d=m("PATTERN");if(R||d){var b=g||"";i.indexOf(b)===-1&&(h+=b,b=""),h&&(o.push(h),h=""),o.push({name:R||v++,prefix:b,suffix:"",pattern:d||u(b),modifier:m("MODIFIER")||""});continue}var y=g||m("ESCAPED_CHAR");if(y){h+=y;continue}h&&(o.push(h),h="");var w=m("OPEN");if(w){var b=c(),P=m("NAME")||"",E=m("PATTERN")||"",S=c();p("CLOSE"),o.push({name:P||(E?v++:""),pattern:P&&!E?u(b):E,prefix:b,suffix:S,modifier:m("MODIFIER")||""});continue}p("END")}return o}function Ze(e,t){var s=[],r=Re(e,s,t);return et(r,s,t)}function et(e,t,s){s===void 0&&(s={});var r=s.decode,i=r===void 0?function(a){return a}:r;return function(a){var n=e.exec(a);if(!n)return!1;for(var o=n[0],v=n.index,l=Object.create(null),h=function(p){if(n[p]===void 0)return"continue";var c=t[p-1];c.modifier==="*"||c.modifier==="+"?l[c.name]=n[p].split(c.prefix+c.suffix).map(function(f){return i(f,c)}):l[c.name]=i(n[p],c)},m=1;m<n.length;m++)h(m);return{path:o,index:v,params:l}}}function M(e){return e.replace(/([.+*?=^!:${}()[\]|/\\])/g,"\\$1")}function Ce(e){return e&&e.sensitive?"":"i"}function tt(e,t){if(!t)return e;for(var s=/\((?:\?<(.*?)>)?(?!\?)/g,r=0,i=s.exec(e.source);i;)t.push({name:i[1]||r++,prefix:"",suffix:"",modifier:"",pattern:""}),i=s.exec(e.source);return e}function st(e,t,s){var r=e.map(function(i){return Re(i,t,s).source});return new RegExp("(?:".concat(r.join("|"),")"),Ce(s))}function rt(e,t,s){return it(Xe(e,s),t,s)}function it(e,t,s){s===void 0&&(s={});for(var r=s.strict,i=r===void 0?!1:r,a=s.start,n=a===void 0?!0:a,o=s.end,v=o===void 0?!0:o,l=s.encode,h=l===void 0?function(C){return C}:l,m=s.delimiter,p=m===void 0?"/#?":m,c=s.endsWith,f=c===void 0?"":c,u="[".concat(M(f),"]|$"),g="[".concat(M(p),"]"),R=n?"^":"",d=0,b=e;d<b.length;d++){var y=b[d];if(typeof y=="string")R+=M(h(y));else{var w=M(h(y.prefix)),P=M(h(y.suffix));if(y.pattern)if(t&&t.push(y),w||P)if(y.modifier==="+"||y.modifier==="*"){var E=y.modifier==="*"?"?":"";R+="(?:".concat(w,"((?:").concat(y.pattern,")(?:").concat(P).concat(w,"(?:").concat(y.pattern,"))*)").concat(P,")").concat(E)}else R+="(?:".concat(w,"(").concat(y.pattern,")").concat(P,")").concat(y.modifier);else{if(y.modifier==="+"||y.modifier==="*")throw new TypeError('Can not repeat "'.concat(y.name,'" without a prefix and suffix'));R+="(".concat(y.pattern,")").concat(y.modifier)}else R+="(?:".concat(w).concat(P,")").concat(y.modifier)}}if(v)i||(R+="".concat(g,"?")),R+=s.endsWith?"(?=".concat(u,")"):"$";else{var S=e[e.length-1],O=typeof S=="string"?g.indexOf(S[S.length-1])>-1:S===void 0;i||(R+="(?:".concat(g,"(?=").concat(u,"))?")),O||(R+="(?=".concat(g,"|").concat(u,")"))}return new RegExp(R,Ce(s))}function Re(e,t,s){return e instanceof RegExp?tt(e,t):Array.isArray(e)?st(e,t,s):rt(e,t,s)}new TextEncoder;function nt(e){try{return new URL(e),!0}catch{return!1}}function ie(e,t){const r=Object.getOwnPropertySymbols(t).find(i=>i.description===e);if(r)return Reflect.get(t,r)}var k=class extends Response{static isConfigurableStatusCode(e){return e>=200&&e<=599}static isRedirectResponse(e){return k.STATUS_CODES_WITH_REDIRECT.includes(e)}static isResponseWithBody(e){return!k.STATUS_CODES_WITHOUT_BODY.includes(e)}static setUrl(e,t){if(!e||e==="about:"||!nt(e))return;const s=ie("state",t);s?s.urlList.push(new URL(e)):Object.defineProperty(t,"url",{value:e,enumerable:!0,configurable:!0,writable:!1})}static parseRawHeaders(e){const t=new Headers;for(let s=0;s<e.length;s+=2)t.append(e[s],e[s+1]);return t}constructor(e,t={}){var s;const r=(s=t.status)!=null?s:200,i=k.isConfigurableStatusCode(r)?r:200,a=k.isResponseWithBody(r)?e:null;if(super(a,{status:i,statusText:t.statusText,headers:t.headers}),r!==i){const n=ie("state",this);n?n.status=r:Object.defineProperty(this,"status",{value:r,enumerable:!0,configurable:!0,writable:!1})}k.setUrl(t.url,this)}},G=k;G.STATUS_CODES_WITHOUT_BODY=[101,103,204,205,304];G.STATUS_CODES_WITH_REDIRECT=[301,302,303,307,308];function at(e,t=!0){return[t&&e.origin,e.pathname].filter(Boolean).join("")}const ot=/[?|#].*$/g;function Se(e){return e.endsWith("?")?e:e.replace(ot,"")}function ut(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function ct(e,t){if(ut(e)||e.startsWith("*"))return e;const s=t||typeof location<"u"&&location.href;return s?decodeURI(new URL(encodeURI(e),s).href):e}function ht(e,t){if(e instanceof RegExp)return e;const s=ct(e,t);return Se(s)}function lt(e){return e.replace(/([:a-zA-Z_-]*)(\*{1,2})+/g,(t,s,r)=>{const i="(.*)";return s?s.startsWith(":")?`${s}${r}`:`${s}${i}`:i}).replace(/([^/])(:)(?=\d+)/,"$1\\$2").replace(/^([^/]+)(:)(?=\/\/)/,"$1\\$2")}function dt(e,t,s){const r=ht(t,s),i=typeof r=="string"?lt(r):r,a=at(e),n=Ze(i,{decode:decodeURIComponent})(a),o=n&&n.params||{};return{matches:n!==!1,params:o}}var ft=Object.create,Oe=Object.defineProperty,pt=Object.getOwnPropertyDescriptor,we=Object.getOwnPropertyNames,yt=Object.getPrototypeOf,vt=Object.prototype.hasOwnProperty,mt=(e,t)=>function(){return t||(0,e[we(e)[0]])((t={exports:{}}).exports,t),t.exports},gt=(e,t,s,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of we(t))!vt.call(e,i)&&i!==s&&Oe(e,i,{get:()=>t[i],enumerable:!(r=pt(t,i))||r.enumerable});return e},bt=(e,t,s)=>(s=e!=null?ft(yt(e)):{},gt(Oe(s,"default",{value:e,enumerable:!0}),e)),Ct=mt({"node_modules/.pnpm/cookie@1.0.2/node_modules/cookie/dist/index.js"(e){Object.defineProperty(e,"__esModule",{value:!0}),e.parse=o,e.serialize=h;var t=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,s=/^[\u0021-\u003A\u003C-\u007E]*$/,r=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,i=/^[\u0020-\u003A\u003D-\u007E]*$/,a=Object.prototype.toString,n=(()=>{const c=function(){};return c.prototype=Object.create(null),c})();function o(c,f){const u=new n,g=c.length;if(g<2)return u;const R=f?.decode||m;let d=0;do{const b=c.indexOf("=",d);if(b===-1)break;const y=c.indexOf(";",d),w=y===-1?g:y;if(b>w){d=c.lastIndexOf(";",b-1)+1;continue}const P=v(c,d,b),E=l(c,b,P),S=c.slice(P,E);if(u[S]===void 0){let O=v(c,b+1,w),C=l(c,w,O);const T=R(c.slice(O,C));u[S]=T}d=w+1}while(d<g);return u}function v(c,f,u){do{const g=c.charCodeAt(f);if(g!==32&&g!==9)return f}while(++f<u);return u}function l(c,f,u){for(;f>u;){const g=c.charCodeAt(--f);if(g!==32&&g!==9)return f+1}return u}function h(c,f,u){const g=u?.encode||encodeURIComponent;if(!t.test(c))throw new TypeError(`argument name is invalid: ${c}`);const R=g(f);if(!s.test(R))throw new TypeError(`argument val is invalid: ${f}`);let d=c+"="+R;if(!u)return d;if(u.maxAge!==void 0){if(!Number.isInteger(u.maxAge))throw new TypeError(`option maxAge is invalid: ${u.maxAge}`);d+="; Max-Age="+u.maxAge}if(u.domain){if(!r.test(u.domain))throw new TypeError(`option domain is invalid: ${u.domain}`);d+="; Domain="+u.domain}if(u.path){if(!i.test(u.path))throw new TypeError(`option path is invalid: ${u.path}`);d+="; Path="+u.path}if(u.expires){if(!p(u.expires)||!Number.isFinite(u.expires.valueOf()))throw new TypeError(`option expires is invalid: ${u.expires}`);d+="; Expires="+u.expires.toUTCString()}if(u.httpOnly&&(d+="; HttpOnly"),u.secure&&(d+="; Secure"),u.partitioned&&(d+="; Partitioned"),u.priority)switch(typeof u.priority=="string"?u.priority.toLowerCase():void 0){case"low":d+="; Priority=Low";break;case"medium":d+="; Priority=Medium";break;case"high":d+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${u.priority}`)}if(u.sameSite)switch(typeof u.sameSite=="string"?u.sameSite.toLowerCase():u.sameSite){case!0:case"strict":d+="; SameSite=Strict";break;case"lax":d+="; SameSite=Lax";break;case"none":d+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${u.sameSite}`)}return d}function m(c){if(c.indexOf("%")===-1)return c;try{return decodeURIComponent(c)}catch{return c}}function p(c){return a.call(c)==="[object Date]"}}}),ne=bt(Ct()),Ee=ne.default||ne,Rt=Ee.parse,St=Ee.serialize;function Te(e){const t=Rt(e),s={};for(const r in t)typeof t[r]<"u"&&(s[r]=t[r]);return s}function ae(){return Te(document.cookie)}function Ot(e){if(typeof document>"u"||typeof location>"u")return{};switch(e.credentials){case"same-origin":{const t=new URL(e.url);return location.origin===t.origin?ae():{}}case"include":return ae();default:return{}}}function wt(e){const t=e.headers.get("cookie"),s=t?Te(t):{},r=Ot(e);for(const n in r)e.headers.append("cookie",St(n,r[n]));const i=Ie.getCookies(e.url),a=Object.fromEntries(i.map(n=>[n.key,n.value]));for(const n of i)e.headers.append("cookie",n.toString());return{...r,...a,...s}}var F=(e=>(e.HEAD="HEAD",e.GET="GET",e.POST="POST",e.PUT="PUT",e.PATCH="PATCH",e.OPTIONS="OPTIONS",e.DELETE="DELETE",e))(F||{});class Et extends Ue{constructor(t,s,r,i){const a=typeof s=="function"?"[custom predicate]":s;super({info:{header:`${t}${a?` ${a}`:""}`,path:s,method:t},resolver:r,options:i}),this.checkRedundantQueryParameters()}checkRedundantQueryParameters(){const{method:t,path:s}=this.info;!s||s instanceof RegExp||typeof s=="function"||Se(s)===s||H.warn(`Found a redundant usage of query parameters in the request handler URL for "${t} ${s}". Please match against a path instead and access query parameters using "new URL(request.url).searchParams" instead. Learn more: https://mswjs.io/docs/http/intercepting-requests#querysearch-parameters`)}async parse(t){const s=new URL(t.request.url),r=wt(t.request);if(typeof this.info.path=="function"){const a=await this.info.path({request:t.request,cookies:r});return{match:typeof a=="boolean"?{matches:a,params:{}}:a,cookies:r}}return{match:this.info.path?dt(s,this.info.path,t.resolutionContext?.baseUrl):{matches:!1,params:{}},cookies:r}}async predicate(t){const s=this.matchMethod(t.request.method),r=t.parsedResult.match.matches;return s&&r}matchMethod(t){return this.info.method instanceof RegExp?this.info.method.test(t):Ke(this.info.method,t)}extendResolverArgs(t){return{params:t.parsedResult.match?.params||{},cookies:t.parsedResult.cookies}}async log(t){const s=Fe(t.request.url),r=await Ge(t.request),i=await Je(t.response),a=We(i.status);console.groupCollapsed(H.formatMessage(`${Me()} ${t.request.method} ${s} (%c${i.status} ${i.statusText}%c)`),`color:${a}`,"color:inherit"),console.log("Request",r),console.log("Handler:",this),console.log("Response",i),console.groupEnd()}}function U(e){return(t,s,r={})=>new Et(e,t,s,r)}const Vt={all:U(/.+/),head:U(F.HEAD),get:U(F.GET),post:U(F.POST),put:U(F.PUT),delete:U(F.DELETE),patch:U(F.PATCH),options:U(F.OPTIONS)};function Tt(){Qe(typeof URL<"u",H.formatMessage(`Global "URL" class is not defined. This likely means that you're running MSW in an environment that doesn't support all Node.js standard API (e.g. React Native). If that's the case, please use an appropriate polyfill for the "URL" class, like "react-native-url-polyfill".`))}const xt=Symbol("bodyType");class q extends G{[xt]=null;constructor(t,s){const r=_(s);super(t,r),_e(this,r)}static error(){return super.error()}static text(t,s){const r=_(s);return r.headers.has("Content-Type")||r.headers.set("Content-Type","text/plain"),r.headers.has("Content-Length")||r.headers.set("Content-Length",t?new Blob([t]).size.toString():"0"),new q(t,r)}static json(t,s){const r=_(s);r.headers.has("Content-Type")||r.headers.set("Content-Type","application/json");const i=JSON.stringify(t);return r.headers.has("Content-Length")||r.headers.set("Content-Length",i?new Blob([i]).size.toString():"0"),new q(i,r)}static xml(t,s){const r=_(s);return r.headers.has("Content-Type")||r.headers.set("Content-Type","text/xml"),new q(t,r)}static html(t,s){const r=_(s);return r.headers.has("Content-Type")||r.headers.set("Content-Type","text/html"),new q(t,r)}static arrayBuffer(t,s){const r=_(s);return r.headers.has("Content-Type")||r.headers.set("Content-Type","application/octet-stream"),t&&!r.headers.has("Content-Length")&&r.headers.set("Content-Length",t.byteLength.toString()),new q(t,r)}static formData(t,s){return new q(t,_(s))}}Tt();var Pt=class extends qe{#e;#t;#r;#i;#s;#o;#a;constructor(e){super(),this.#a=!1,this.#o=e.defaultOptions,this.setOptions(e.options),this.observers=[],this.#i=e.client,this.#r=this.#i.getQueryCache(),this.queryKey=e.queryKey,this.queryHash=e.queryHash,this.#e=ue(this.options),this.state=e.state??this.#e,this.scheduleGc()}get meta(){return this.options.meta}get promise(){return this.#s?.promise}setOptions(e){if(this.options={...this.#o,...e},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const t=ue(this.options);t.data!==void 0&&(this.setState(oe(t.data,t.dataUpdatedAt)),this.#e=t)}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&this.#r.remove(this)}setData(e,t){const s=$(this.state.data,e,this.options);return this.#n({data:s,type:"success",dataUpdatedAt:t?.updatedAt,manual:t?.manual}),s}setState(e,t){this.#n({type:"setState",state:e,setStateOptions:t})}cancel(e){const t=this.#s?.promise;return this.#s?.cancel(e),t?t.then(A).catch(A):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(this.#e)}isActive(){return this.observers.some(e=>D(e.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===pe||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(e=>Q(e.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(e=>e.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(e=0){return this.state.data===void 0?!0:e==="static"?!1:this.state.isInvalidated?!0:!ye(this.state.dataUpdatedAt,e)}onFocus(){this.observers.find(t=>t.shouldFetchOnWindowFocus())?.refetch({cancelRefetch:!1}),this.#s?.continue()}onOnline(){this.observers.find(t=>t.shouldFetchOnReconnect())?.refetch({cancelRefetch:!1}),this.#s?.continue()}addObserver(e){this.observers.includes(e)||(this.observers.push(e),this.clearGcTimeout(),this.#r.notify({type:"observerAdded",query:this,observer:e}))}removeObserver(e){this.observers.includes(e)&&(this.observers=this.observers.filter(t=>t!==e),this.observers.length||(this.#s&&(this.#a?this.#s.cancel({revert:!0}):this.#s.cancelRetry()),this.scheduleGc()),this.#r.notify({type:"observerRemoved",query:this,observer:e}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||this.#n({type:"invalidate"})}async fetch(e,t){if(this.state.fetchStatus!=="idle"&&this.#s?.status()!=="rejected"){if(this.state.data!==void 0&&t?.cancelRefetch)this.cancel({silent:!0});else if(this.#s)return this.#s.continueRetry(),this.#s.promise}if(e&&this.setOptions(e),!this.options.queryFn){const o=this.observers.find(v=>v.options.queryFn);o&&this.setOptions(o.options)}const s=new AbortController,r=o=>{Object.defineProperty(o,"signal",{enumerable:!0,get:()=>(this.#a=!0,s.signal)})},i=()=>{const o=ve(this.options,t),l=(()=>{const h={client:this.#i,queryKey:this.queryKey,meta:this.meta};return r(h),h})();return this.#a=!1,this.options.persister?this.options.persister(o,l,this):o(l)},n=(()=>{const o={fetchOptions:t,options:this.options,queryKey:this.queryKey,client:this.#i,state:this.state,fetchFn:i};return r(o),o})();this.options.behavior?.onFetch(n,this),this.#t=this.state,(this.state.fetchStatus==="idle"||this.state.fetchMeta!==n.fetchOptions?.meta)&&this.#n({type:"fetch",meta:n.fetchOptions?.meta}),this.#s=ke({initialPromise:t?.initialPromise,fn:n.fetchFn,onCancel:o=>{o instanceof J&&o.revert&&this.setState({...this.#t,fetchStatus:"idle"}),s.abort()},onFail:(o,v)=>{this.#n({type:"failed",failureCount:o,error:v})},onPause:()=>{this.#n({type:"pause"})},onContinue:()=>{this.#n({type:"continue"})},retry:n.options.retry,retryDelay:n.options.retryDelay,networkMode:n.options.networkMode,canRun:()=>!0});try{const o=await this.#s.start();if(o===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(o),this.#r.config.onSuccess?.(o,this),this.#r.config.onSettled?.(o,this.state.error,this),o}catch(o){if(o instanceof J){if(o.silent)return this.#s.promise;if(o.revert){if(this.state.data===void 0)throw o;return this.state.data}}throw this.#n({type:"error",error:o}),this.#r.config.onError?.(o,this),this.#r.config.onSettled?.(this.state.data,o,this),o}finally{this.scheduleGc()}}#n(e){const t=s=>{switch(e.type){case"failed":return{...s,fetchFailureCount:e.failureCount,fetchFailureReason:e.error};case"pause":return{...s,fetchStatus:"paused"};case"continue":return{...s,fetchStatus:"fetching"};case"fetch":return{...s,...xe(s.data,this.options),fetchMeta:e.meta??null};case"success":const r={...s,...oe(e.data,e.dataUpdatedAt),dataUpdateCount:s.dataUpdateCount+1,...!e.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return this.#t=e.manual?r:void 0,r;case"error":const i=e.error;return{...s,error:i,errorUpdateCount:s.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:s.fetchFailureCount+1,fetchFailureReason:i,fetchStatus:"idle",status:"error",isInvalidated:!0};case"invalidate":return{...s,isInvalidated:!0};case"setState":return{...s,...e.state}}};this.state=t(this.state),x.batch(()=>{this.observers.forEach(s=>{s.onQueryUpdate()}),this.#r.notify({query:this,type:"updated",action:e})})}};function xe(e,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:Le(t.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}function oe(e,t){return{data:e,dataUpdatedAt:t??Date.now(),error:null,isInvalidated:!1,status:"success"}}function ue(e){const t=typeof e.initialData=="function"?e.initialData():e.initialData,s=t!==void 0,r=s?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:s?r??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:s?"success":"pending",fetchStatus:"idle"}}var At=class extends W{constructor(e,t){super(),this.options=t,this.#e=e,this.#n=null,this.#a=Y(),this.bindMethods(),this.setOptions(t)}#e;#t=void 0;#r=void 0;#i=void 0;#s;#o;#a;#n;#y;#d;#f;#c;#h;#u;#p=new Set;bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(this.#t.addObserver(this),ce(this.#t,this.options)?this.#l():this.updateResult(),this.#b())}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return K(this.#t,this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return K(this.#t,this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,this.#C(),this.#R(),this.#t.removeObserver(this)}setOptions(e){const t=this.options,s=this.#t;if(this.options=this.#e.defaultQueryOptions(e),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof D(this.options.enabled,this.#t)!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");this.#S(),this.#t.setOptions(this.options),t._defaulted&&!B(this.options,t)&&this.#e.getQueryCache().notify({type:"observerOptionsUpdated",query:this.#t,observer:this});const r=this.hasListeners();r&&he(this.#t,s,this.options,t)&&this.#l(),this.updateResult(),r&&(this.#t!==s||D(this.options.enabled,this.#t)!==D(t.enabled,this.#t)||Q(this.options.staleTime,this.#t)!==Q(t.staleTime,this.#t))&&this.#v();const i=this.#m();r&&(this.#t!==s||D(this.options.enabled,this.#t)!==D(t.enabled,this.#t)||i!==this.#u)&&this.#g(i)}getOptimisticResult(e){const t=this.#e.getQueryCache().build(this.#e,e),s=this.createResult(t,e);return It(this,s)&&(this.#i=s,this.#o=this.options,this.#s=this.#t.state),s}getCurrentResult(){return this.#i}trackResult(e,t){return new Proxy(e,{get:(s,r)=>(this.trackProp(r),t?.(r),r==="promise"&&(this.trackProp("data"),!this.options.experimental_prefetchInRender&&this.#a.status==="pending"&&this.#a.reject(new Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(s,r))})}trackProp(e){this.#p.add(e)}getCurrentQuery(){return this.#t}refetch({...e}={}){return this.fetch({...e})}fetchOptimistic(e){const t=this.#e.defaultQueryOptions(e),s=this.#e.getQueryCache().build(this.#e,t);return s.fetch().then(()=>this.createResult(s,t))}fetch(e){return this.#l({...e,cancelRefetch:e.cancelRefetch??!0}).then(()=>(this.updateResult(),this.#i))}#l(e){this.#S();let t=this.#t.fetch(this.options,e);return e?.throwOnError||(t=t.catch(A)),t}#v(){this.#C();const e=Q(this.options.staleTime,this.#t);if(z||this.#i.isStale||!X(e))return;const s=ye(this.#i.dataUpdatedAt,e)+1;this.#c=L.setTimeout(()=>{this.#i.isStale||this.updateResult()},s)}#m(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(this.#t):this.options.refetchInterval)??!1}#g(e){this.#R(),this.#u=e,!(z||D(this.options.enabled,this.#t)===!1||!X(this.#u)||this.#u===0)&&(this.#h=L.setInterval(()=>{(this.options.refetchIntervalInBackground||me.isFocused())&&this.#l()},this.#u))}#b(){this.#v(),this.#g(this.#m())}#C(){this.#c&&(L.clearTimeout(this.#c),this.#c=void 0)}#R(){this.#h&&(L.clearInterval(this.#h),this.#h=void 0)}createResult(e,t){const s=this.#t,r=this.options,i=this.#i,a=this.#s,n=this.#o,v=e!==s?e.state:this.#r,{state:l}=e;let h={...l},m=!1,p;if(t._optimisticResults){const S=this.hasListeners(),O=!S&&ce(e,t),C=S&&he(e,s,t,r);(O||C)&&(h={...h,...xe(l.data,e.options)}),t._optimisticResults==="isRestoring"&&(h.fetchStatus="idle")}let{error:c,errorUpdatedAt:f,status:u}=h;p=h.data;let g=!1;if(t.placeholderData!==void 0&&p===void 0&&u==="pending"){let S;i?.isPlaceholderData&&t.placeholderData===n?.placeholderData?(S=i.data,g=!0):S=typeof t.placeholderData=="function"?t.placeholderData(this.#f?.state.data,this.#f):t.placeholderData,S!==void 0&&(u="success",p=$(i?.data,S,t),m=!0)}if(t.select&&p!==void 0&&!g)if(i&&p===a?.data&&t.select===this.#y)p=this.#d;else try{this.#y=t.select,p=t.select(p),p=$(i?.data,p,t),this.#d=p,this.#n=null}catch(S){this.#n=S}this.#n&&(c=this.#n,p=this.#d,f=Date.now(),u="error");const R=h.fetchStatus==="fetching",d=u==="pending",b=u==="error",y=d&&R,w=p!==void 0,E={status:u,fetchStatus:h.fetchStatus,isPending:d,isSuccess:u==="success",isError:b,isInitialLoading:y,isLoading:y,data:p,dataUpdatedAt:h.dataUpdatedAt,error:c,errorUpdatedAt:f,failureCount:h.fetchFailureCount,failureReason:h.fetchFailureReason,errorUpdateCount:h.errorUpdateCount,isFetched:h.dataUpdateCount>0||h.errorUpdateCount>0,isFetchedAfterMount:h.dataUpdateCount>v.dataUpdateCount||h.errorUpdateCount>v.errorUpdateCount,isFetching:R,isRefetching:R&&!d,isLoadingError:b&&!w,isPaused:h.fetchStatus==="paused",isPlaceholderData:m,isRefetchError:b&&w,isStale:V(e,t),refetch:this.refetch,promise:this.#a,isEnabled:D(t.enabled,e)!==!1};if(this.options.experimental_prefetchInRender){const S=T=>{E.status==="error"?T.reject(E.error):E.data!==void 0&&T.resolve(E.data)},O=()=>{const T=this.#a=E.promise=Y();S(T)},C=this.#a;switch(C.status){case"pending":e.queryHash===s.queryHash&&S(C);break;case"fulfilled":(E.status==="error"||E.data!==C.value)&&O();break;case"rejected":(E.status!=="error"||E.error!==C.reason)&&O();break}}return E}updateResult(){const e=this.#i,t=this.createResult(this.#t,this.options);if(this.#s=this.#t.state,this.#o=this.options,this.#s.data!==void 0&&(this.#f=this.#t),B(t,e))return;this.#i=t;const s=()=>{if(!e)return!0;const{notifyOnChangeProps:r}=this.options,i=typeof r=="function"?r():r;if(i==="all"||!i&&!this.#p.size)return!0;const a=new Set(i??this.#p);return this.options.throwOnError&&a.add("error"),Object.keys(this.#i).some(n=>{const o=n;return this.#i[o]!==e[o]&&a.has(o)})};this.#O({listeners:s()})}#S(){const e=this.#e.getQueryCache().build(this.#e,this.options);if(e===this.#t)return;const t=this.#t;this.#t=e,this.#r=e.state,this.hasListeners()&&(t?.removeObserver(this),e.addObserver(this))}onQueryUpdate(){this.updateResult(),this.hasListeners()&&this.#b()}#O(e){x.batch(()=>{e.listeners&&this.listeners.forEach(t=>{t(this.#i)}),this.#e.getQueryCache().notify({query:this.#t,type:"observerResultsUpdated"})})}};function Dt(e,t){return D(t.enabled,e)!==!1&&e.state.data===void 0&&!(e.state.status==="error"&&t.retryOnMount===!1)}function ce(e,t){return Dt(e,t)||e.state.data!==void 0&&K(e,t,t.refetchOnMount)}function K(e,t,s){if(D(t.enabled,e)!==!1&&Q(t.staleTime,e)!=="static"){const r=typeof s=="function"?s(e):s;return r==="always"||r!==!1&&V(e,t)}return!1}function he(e,t,s,r){return(e!==t||D(r.enabled,e)===!1)&&(!s.suspense||e.state.status!=="error")&&V(e,s)}function V(e,t){return D(t.enabled,e)!==!1&&e.isStaleByTime(Q(t.staleTime,e))}function It(e,t){return!B(e.getCurrentResult(),t)}function le(e){return{onFetch:(t,s)=>{const r=t.options,i=t.fetchOptions?.meta?.fetchMore?.direction,a=t.state.data?.pages||[],n=t.state.data?.pageParams||[];let o={pages:[],pageParams:[]},v=0;const l=async()=>{let h=!1;const m=f=>{He(f,()=>t.signal,()=>h=!0)},p=ve(t.options,t.fetchOptions),c=async(f,u,g)=>{if(h)return Promise.reject();if(u==null&&f.pages.length)return Promise.resolve(f);const d=(()=>{const P={client:t.client,queryKey:t.queryKey,pageParam:u,direction:g?"backward":"forward",meta:t.options.meta};return m(P),P})(),b=await p(d),{maxPages:y}=t.options,w=g?Ne:je;return{pages:w(f.pages,b,y),pageParams:w(f.pageParams,u,y)}};if(i&&a.length){const f=i==="backward",u=f?Ut:de,g={pages:a,pageParams:n},R=u(r,g);o=await c(g,R,f)}else{const f=e??a.length;do{const u=v===0?n[0]??r.initialPageParam:de(r,o);if(v>0&&u==null)break;o=await c(o,u),v++}while(v<f)}return o};t.options.persister?t.fetchFn=()=>t.options.persister?.(l,{client:t.client,queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},s):t.fetchFn=l}}}function de(e,{pages:t,pageParams:s}){const r=t.length-1;return t.length>0?e.getNextPageParam(t[r],t,s[r],s):void 0}function Ut(e,{pages:t,pageParams:s}){return t.length>0?e.getPreviousPageParam?.(t[0],t,s[0],s):void 0}var Ft=class extends W{constructor(e={}){super(),this.config=e,this.#e=new Set,this.#t=new Map,this.#r=0}#e;#t;#r;build(e,t,s){const r=new $e({client:e,mutationCache:this,mutationId:++this.#r,options:e.defaultMutationOptions(t),state:s});return this.add(r),r}add(e){this.#e.add(e);const t=N(e);if(typeof t=="string"){const s=this.#t.get(t);s?s.push(e):this.#t.set(t,[e])}this.notify({type:"added",mutation:e})}remove(e){if(this.#e.delete(e)){const t=N(e);if(typeof t=="string"){const s=this.#t.get(t);if(s)if(s.length>1){const r=s.indexOf(e);r!==-1&&s.splice(r,1)}else s[0]===e&&this.#t.delete(t)}}this.notify({type:"removed",mutation:e})}canRun(e){const t=N(e);if(typeof t=="string"){const r=this.#t.get(t)?.find(i=>i.state.status==="pending");return!r||r===e}else return!0}runNext(e){const t=N(e);return typeof t=="string"?this.#t.get(t)?.find(r=>r!==e&&r.state.isPaused)?.continue()??Promise.resolve():Promise.resolve()}clear(){x.batch(()=>{this.#e.forEach(e=>{this.notify({type:"removed",mutation:e})}),this.#e.clear(),this.#t.clear()})}getAll(){return Array.from(this.#e)}find(e){const t={exact:!0,...e};return this.getAll().find(s=>Z(t,s))}findAll(e={}){return this.getAll().filter(t=>Z(e,t))}notify(e){x.batch(()=>{this.listeners.forEach(t=>{t(e)})})}resumePausedMutations(){const e=this.getAll().filter(t=>t.state.isPaused);return x.batch(()=>Promise.all(e.map(t=>t.continue().catch(A))))}};function N(e){return e.options.scope?.id}var Mt=class extends W{constructor(e={}){super(),this.config=e,this.#e=new Map}#e;build(e,t,s){const r=t.queryKey,i=t.queryHash??ge(r,t);let a=this.get(i);return a||(a=new Pt({client:e,queryKey:r,queryHash:i,options:e.defaultQueryOptions(t),state:s,defaultOptions:e.getQueryDefaults(r)}),this.add(a)),a}add(e){this.#e.has(e.queryHash)||(this.#e.set(e.queryHash,e),this.notify({type:"added",query:e}))}remove(e){const t=this.#e.get(e.queryHash);t&&(e.destroy(),t===e&&this.#e.delete(e.queryHash),this.notify({type:"removed",query:e}))}clear(){x.batch(()=>{this.getAll().forEach(e=>{this.remove(e)})})}get(e){return this.#e.get(e)}getAll(){return[...this.#e.values()]}find(e){const t={exact:!0,...e};return this.getAll().find(s=>ee(t,s))}findAll(e={}){const t=this.getAll();return Object.keys(e).length>0?t.filter(s=>ee(e,s)):t}notify(e){x.batch(()=>{this.listeners.forEach(t=>{t(e)})})}onFocus(){x.batch(()=>{this.getAll().forEach(e=>{e.onFocus()})})}onOnline(){x.batch(()=>{this.getAll().forEach(e=>{e.onOnline()})})}},Jt=class{#e;#t;#r;#i;#s;#o;#a;#n;constructor(e={}){this.#e=e.queryCache||new Mt,this.#t=e.mutationCache||new Ft,this.#r=e.defaultOptions||{},this.#i=new Map,this.#s=new Map,this.#o=0}mount(){this.#o++,this.#o===1&&(this.#a=me.subscribe(async e=>{e&&(await this.resumePausedMutations(),this.#e.onFocus())}),this.#n=te.subscribe(async e=>{e&&(await this.resumePausedMutations(),this.#e.onOnline())}))}unmount(){this.#o--,this.#o===0&&(this.#a?.(),this.#a=void 0,this.#n?.(),this.#n=void 0)}isFetching(e){return this.#e.findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return this.#t.findAll({...e,status:"pending"}).length}getQueryData(e){const t=this.defaultQueryOptions({queryKey:e});return this.#e.get(t.queryHash)?.state.data}ensureQueryData(e){const t=this.defaultQueryOptions(e),s=this.#e.build(this,t),r=s.state.data;return r===void 0?this.fetchQuery(e):(e.revalidateIfStale&&s.isStaleByTime(Q(t.staleTime,s))&&this.prefetchQuery(t),Promise.resolve(r))}getQueriesData(e){return this.#e.findAll(e).map(({queryKey:t,state:s})=>{const r=s.data;return[t,r]})}setQueryData(e,t,s){const r=this.defaultQueryOptions({queryKey:e}),a=this.#e.get(r.queryHash)?.state.data,n=Be(t,a);if(n!==void 0)return this.#e.build(this,r).setData(n,{...s,manual:!0})}setQueriesData(e,t,s){return x.batch(()=>this.#e.findAll(e).map(({queryKey:r})=>[r,this.setQueryData(r,t,s)]))}getQueryState(e){const t=this.defaultQueryOptions({queryKey:e});return this.#e.get(t.queryHash)?.state}removeQueries(e){const t=this.#e;x.batch(()=>{t.findAll(e).forEach(s=>{t.remove(s)})})}resetQueries(e,t){const s=this.#e;return x.batch(()=>(s.findAll(e).forEach(r=>{r.reset()}),this.refetchQueries({type:"active",...e},t)))}cancelQueries(e,t={}){const s={revert:!0,...t},r=x.batch(()=>this.#e.findAll(e).map(i=>i.cancel(s)));return Promise.all(r).then(A).catch(A)}invalidateQueries(e,t={}){return x.batch(()=>(this.#e.findAll(e).forEach(s=>{s.invalidate()}),e?.refetchType==="none"?Promise.resolve():this.refetchQueries({...e,type:e?.refetchType??e?.type??"active"},t)))}refetchQueries(e,t={}){const s={...t,cancelRefetch:t.cancelRefetch??!0},r=x.batch(()=>this.#e.findAll(e).filter(i=>!i.isDisabled()&&!i.isStatic()).map(i=>{let a=i.fetch(void 0,s);return s.throwOnError||(a=a.catch(A)),i.state.fetchStatus==="paused"?Promise.resolve():a}));return Promise.all(r).then(A)}fetchQuery(e){const t=this.defaultQueryOptions(e);t.retry===void 0&&(t.retry=!1);const s=this.#e.build(this,t);return s.isStaleByTime(Q(t.staleTime,s))?s.fetch(t):Promise.resolve(s.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(A).catch(A)}fetchInfiniteQuery(e){return e.behavior=le(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(A).catch(A)}ensureInfiniteQueryData(e){return e.behavior=le(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return te.isOnline()?this.#t.resumePausedMutations():Promise.resolve()}getQueryCache(){return this.#e}getMutationCache(){return this.#t}getDefaultOptions(){return this.#r}setDefaultOptions(e){this.#r=e}setQueryDefaults(e,t){this.#i.set(se(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...this.#i.values()],s={};return t.forEach(r=>{re(e,r.queryKey)&&Object.assign(s,r.defaultOptions)}),s}setMutationDefaults(e,t){this.#s.set(se(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...this.#s.values()],s={};return t.forEach(r=>{re(e,r.mutationKey)&&Object.assign(s,r.defaultOptions)}),s}defaultQueryOptions(e){if(e._defaulted)return e;const t={...this.#r.queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return t.queryHash||(t.queryHash=ge(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.queryFn===pe&&(t.enabled=!1),t}defaultMutationOptions(e){return e?._defaulted?e:{...this.#r.mutations,...e?.mutationKey&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){this.#e.clear(),this.#t.clear()}},Pe=I.createContext(!1),Qt=()=>I.useContext(Pe);Pe.Provider;function _t(){let e=!1;return{clearReset:()=>{e=!1},reset:()=>{e=!0},isReset:()=>e}}var qt=I.createContext(_t()),kt=()=>I.useContext(qt),Lt=(e,t,s)=>{const r=s?.state.error&&typeof e.throwOnError=="function"?be(e.throwOnError,[s.state.error,s]):e.throwOnError;(e.suspense||e.experimental_prefetchInRender||r)&&(t.isReset()||(e.retryOnMount=!1))},Nt=e=>{I.useEffect(()=>{e.clearReset()},[e])},jt=({result:e,errorResetBoundary:t,throwOnError:s,query:r,suspense:i})=>e.isError&&!t.isReset()&&!e.isFetching&&r&&(i&&e.data===void 0||be(s,[e.error,r])),Ht=e=>{if(e.suspense){const s=i=>i==="static"?i:Math.max(i??1e3,1e3),r=e.staleTime;e.staleTime=typeof r=="function"?(...i)=>s(r(...i)):s(r),typeof e.gcTime=="number"&&(e.gcTime=Math.max(e.gcTime,1e3))}},$t=(e,t)=>e.isLoading&&e.isFetching&&!t,Bt=(e,t)=>e?.suspense&&t.isPending,fe=(e,t,s)=>t.fetchOptimistic(e).catch(()=>{s.clearReset()});function zt(e,t,s){const r=Qt(),i=kt(),a=ze(),n=a.defaultQueryOptions(e);a.getDefaultOptions().queries?._experimental_beforeQuery?.(n);const o=a.getQueryCache().get(n.queryHash);n._optimisticResults=r?"isRestoring":"optimistic",Ht(n),Lt(n,i,o),Nt(i);const v=!a.getQueryCache().get(n.queryHash),[l]=I.useState(()=>new t(a,n)),h=l.getOptimisticResult(n),m=!r&&e.subscribed!==!1;if(I.useSyncExternalStore(I.useCallback(p=>{const c=m?l.subscribe(x.batchCalls(p)):A;return l.updateResult(),c},[l,m]),()=>l.getCurrentResult(),()=>l.getCurrentResult()),I.useEffect(()=>{l.setOptions(n)},[n,l]),Bt(n,h))throw fe(n,l,i);if(jt({result:h,errorResetBoundary:i,throwOnError:n.throwOnError,query:o,suspense:n.suspense}))throw h.error;return a.getDefaultOptions().queries?._experimental_afterQuery?.(n,h),n.experimental_prefetchInRender&&!z&&$t(h,r)&&(v?fe(n,l,i):o?.promise)?.catch(A).finally(()=>{l.updateResult()}),n.notifyOnChangeProps?h:l.trackResult(h)}function Yt(e,t){return zt(e,At)}export{q as H,Jt as Q,Vt as h,Yt as u};
