import{r as m}from"./iframe-BHN6nb68.js";import{S as P,s as E,k as v,l as $,h as j,u as A,n as U,j as q}from"./QueryClientProvider-CdP_kVfl.js";var I=class extends P{#t;#r=void 0;#e;#s;constructor(e,r){super(),this.#t=e,this.setOptions(r),this.bindMethods(),this.#o()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(e){const r=this.options;this.options=this.#t.defaultMutationOptions(e),E(this.options,r)||this.#t.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#e,observer:this}),r?.mutationKey&&this.options.mutationKey&&v(r.mutationKey)!==v(this.options.mutationKey)?this.reset():this.#e?.state.status==="pending"&&this.#e.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#e?.removeObserver(this)}onMutationUpdate(e){this.#o(),this.#i(e)}getCurrentResult(){return this.#r}reset(){this.#e?.removeObserver(this),this.#e=void 0,this.#o(),this.#i()}mutate(e,r){return this.#s=r,this.#e?.removeObserver(this),this.#e=this.#t.getMutationCache().build(this.#t,this.options),this.#e.addObserver(this),this.#e.execute(e)}#o(){const e=this.#e?.state??$();this.#r={...e,isPending:e.status==="pending",isSuccess:e.status==="success",isError:e.status==="error",isIdle:e.status==="idle",mutate:this.mutate,reset:this.reset}}#i(e){j.batch(()=>{if(this.#s&&this.hasListeners()){const r=this.#r.variables,t=this.#r.context,s={client:this.#t,meta:this.options.meta,mutationKey:this.options.mutationKey};if(e?.type==="success"){try{this.#s.onSuccess?.(e.data,r,t,s)}catch(o){Promise.reject(o)}try{this.#s.onSettled?.(e.data,null,r,t,s)}catch(o){Promise.reject(o)}}else if(e?.type==="error"){try{this.#s.onError?.(e.error,r,t,s)}catch(o){Promise.reject(o)}try{this.#s.onSettled?.(void 0,e.error,r,t,s)}catch(o){Promise.reject(o)}}}this.listeners.forEach(r=>{r(this.#r)})})}};function N(e,r){const t=A(),[s]=m.useState(()=>new I(t,e));m.useEffect(()=>{s.setOptions(e)},[s,e]);const o=m.useSyncExternalStore(m.useCallback(a=>s.subscribe(j.batchCalls(a)),[s]),()=>s.getCurrentResult(),()=>s.getCurrentResult()),i=m.useCallback((a,h)=>{s.mutate(a,h).catch(U)},[s]);if(o.error&&q(s.options.throwOnError,[o.error]))throw o.error;return{...o,mutate:i,mutateAsync:o.mutate}}var _=(e,r,t={})=>{let s=`${e}=${r}`;if(e.startsWith("__Secure-")&&!t.secure)throw new Error("__Secure- Cookie must have Secure attributes");if(e.startsWith("__Host-")){if(!t.secure)throw new Error("__Host- Cookie must have Secure attributes");if(t.path!=="/")throw new Error('__Host- Cookie must have Path attributes with "/"');if(t.domain)throw new Error("__Host- Cookie must not have Domain attributes")}if(t&&typeof t.maxAge=="number"&&t.maxAge>=0){if(t.maxAge>3456e4)throw new Error("Cookies Max-Age SHOULD NOT be greater than 400 days (34560000 seconds) in duration.");s+=`; Max-Age=${t.maxAge|0}`}if(t.domain&&t.prefix!=="host"&&(s+=`; Domain=${t.domain}`),t.path&&(s+=`; Path=${t.path}`),t.expires){if(t.expires.getTime()-Date.now()>3456e7)throw new Error("Cookies Expires SHOULD NOT be greater than 400 days (34560000 seconds) in the future.");s+=`; Expires=${t.expires.toUTCString()}`}if(t.httpOnly&&(s+="; HttpOnly"),t.secure&&(s+="; Secure"),t.sameSite&&(s+=`; SameSite=${t.sameSite.charAt(0).toUpperCase()+t.sameSite.slice(1)}`),t.priority&&(s+=`; Priority=${t.priority.charAt(0).toUpperCase()+t.priority.slice(1)}`),t.partitioned){if(!t.secure)throw new Error("Partitioned Cookie must have Secure attributes");s+="; Partitioned"}return s},B=(e,r,t)=>(r=encodeURIComponent(r),_(e,r,t)),M=(e,r)=>(e=e.replace(/\/+$/,""),e=e+"/",r=r.replace(/^\/+/,""),e+r),b=(e,r)=>{for(const[t,s]of Object.entries(r)){const o=new RegExp("/:"+t+"(?:{[^/]+})?\\??");e=e.replace(o,s?`/${s}`:"")}return e},k=e=>{const r=new URLSearchParams;for(const[t,s]of Object.entries(e))if(s!==void 0)if(Array.isArray(s))for(const o of s)r.append(t,o);else r.set(t,s);return r},R=(e,r)=>{switch(r){case"ws":return e.replace(/^http/,"ws");case"http":return e.replace(/^ws/,"http")}},S=e=>/^https?:\/\/[^\/]+?\/index(?=\?|$)/.test(e)?e.replace(/\/index(?=\?|$)/,"/"):e.replace(/\/index(?=\?|$)/,"");function l(e){return typeof e=="object"&&e!==null&&!Array.isArray(e)}function C(e,r){if(!l(e)&&!l(r))return r;const t={...e};for(const s in r){const o=r[s];l(t[s])&&l(o)?t[s]=C(t[s],o):t[s]=o}return t}var x=(e,r)=>new Proxy(()=>{},{get(s,o){if(!(typeof o!="string"||o==="then"))return x(e,[...r,o])},apply(s,o,i){return e({path:r,args:i})}}),T=class{url;method;queryParams=void 0;pathParams={};rBody;cType=void 0;constructor(e,r){this.url=e,this.method=r}fetch=async(e,r)=>{if(e){if(e.query&&(this.queryParams=k(e.query)),e.form){const h=new FormData;for(const[u,p]of Object.entries(e.form))if(Array.isArray(p))for(const n of p)h.append(u,n);else h.append(u,p);this.rBody=h}e.json&&(this.rBody=JSON.stringify(e.json),this.cType="application/json"),e.param&&(this.pathParams=e.param)}let t=this.method.toUpperCase();const s={...e?.header,...typeof r?.headers=="function"?await r.headers():r?.headers};if(e?.cookie){const h=[];for(const[u,p]of Object.entries(e.cookie))h.push(B(u,p,{path:"/"}));s.Cookie=h.join(",")}this.cType&&(s["Content-Type"]=this.cType);const o=new Headers(s??void 0);let i=this.url;i=S(i),i=b(i,this.pathParams),this.queryParams&&(i=i+"?"+this.queryParams.toString()),t=this.method.toUpperCase();const a=!(t==="GET"||t==="HEAD");return(r?.fetch||fetch)(i,{body:a?this.rBody:void 0,method:t,headers:o,...r?.init})}},G=(e,r)=>x(function t(s){const o=[...s.path],i=o.slice(-3).reverse();if(i[0]==="toString")return i[1]==="name"?i[2]||"":t.toString();if(i[0]==="valueOf")return i[1]==="name"?i[2]||"":t;let a="";if(/^\$/.test(i[0])){const n=o.pop();n&&(a=n.replace(/^\$/,""))}const h=o.join("/"),u=M(e,h);if(a==="url"){let n=u;return s.args[0]&&(s.args[0].param&&(n=b(u,s.args[0].param)),s.args[0].query&&(n=n+"?"+k(s.args[0].query).toString())),n=S(n),new URL(n)}if(a==="ws"){const n=R(s.args[0]&&s.args[0].param?b(u,s.args[0].param):u,"ws"),y=new URL(n),g=s.args[0]?.query;return g&&Object.entries(g).forEach(([d,w])=>{Array.isArray(w)?w.forEach(O=>y.searchParams.append(d,O)):y.searchParams.set(d,w)}),((...d)=>r?.webSocket!==void 0&&typeof r.webSocket=="function"?r.webSocket(...d):new WebSocket(...d))(y.toString())}const p=new T(u,a);if(a){r??={};const n=C(r,{...s.args[1]});return p.fetch(s.args[0],n)}return p},[]);const H="",D=G(H,{fetch:(e,r)=>fetch(e,{...r,credentials:"include"})});class c extends Error{status;constructor(r,t){super(t),this.status=r,this.name="ApiError"}}const f=D.api.groups,z=async()=>{const r=await f.$get();if(!r.ok)throw new Error("グループ一覧の取得に失敗しました");return r.json()},F=async({groupId:e})=>{const t=await f[":groupId"].chores.$get({param:{groupId:e}});if(!t.ok)throw new c(t.status,"家事一覧の取得に失敗しました");return t.json()},J=async({groupId:e,date:r})=>{const t=await f[":groupId"].beatings.$get({param:{groupId:e},query:{date:r}});if(t.status===422){const o=(await t.json()).errors.map(i=>i.message).filter(Boolean).join(" / ");throw new c(422,o||"入力内容を確認してください")}if(!t.ok)throw new c(t.status,"討伐ログの取得に失敗しました");return t.json()},Q=async({groupId:e,email:r})=>{const s=await f[":groupId"].search.users.$get({param:{groupId:e},query:{email:r}});if(s.status===422){const i=(await s.json()).errors.map(a=>a.message).filter(Boolean).join(" / ");throw new c(422,i||"入力内容を確認してください")}if(!s.ok)throw new c(s.status,"ユーザー検索に失敗しました");return s.json()},V=async({groupId:e,chore_id:r,beated_at:t})=>{const o=await f[":groupId"].beatings.$post({param:{groupId:e},json:{chore_id:r,beated_at:t}});if(o.status===422){const a=(await o.json()).errors.map(h=>h.message).filter(Boolean).join(" / ");throw new c(422,a||"入力内容を確認してください")}if(!o.ok)throw new c(o.status,"討伐記録の作成に失敗しました");return o.json()},X=async({groupId:e,beatingId:r})=>{const s=await f[":groupId"].beatings[":beatingId"].likes.$post({param:{groupId:e,beatingId:String(r)}});if(s.status===422){const i=(await s.json()).errors.map(a=>a.message).filter(Boolean).join(" / ");throw new c(422,i||"入力内容を確認してください")}if(!s.ok)throw new c(s.status,"いいねの送信に失敗しました");return s.json()},Y=async({name:e})=>{const t=await f.$post({json:{name:e}});if(!t.ok)throw new Error("グループの作成に失敗しました");return t.json()},Z=async({groupId:e,user_id:r})=>{const s=await f[":groupId"].invitations.$post({param:{groupId:e},json:{user_id:r}});if(s.status===422){const i=(await s.json()).errors.map(a=>a.message).filter(Boolean).join(" / ");throw new c(422,i||"入力内容を確認してください")}if(!s.ok)throw new c(s.status,"ユーザー招待に失敗しました");return s.json()},ee=async({groupId:e})=>{const t=await f[":groupId"].invitations.accept.$post({param:{groupId:e}});if(t.status===422){const o=(await t.json()).errors.map(i=>i.message).filter(Boolean).join(" / ");throw new c(422,o||"入力内容を確認してください")}if(!t.ok)throw new c(t.status,"招待の承認に失敗しました")},te=async({groupId:e})=>{const t=await f[":groupId"].invitations.deny.$post({param:{groupId:e}});if(t.status===422){const o=(await t.json()).errors.map(i=>i.message).filter(Boolean).join(" / ");throw new c(422,o||"入力内容を確認してください")}if(!t.ok)throw new c(t.status,"招待の拒否に失敗しました")};export{c as A,J as a,X as b,V as c,z as d,Y as e,F as f,ee as g,te as h,Z as i,Q as s,N as u};
