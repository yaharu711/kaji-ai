import{j as a}from"./jsx-runtime-u17CrQMm.js";import{u as T,f as A,a as L,c as q,A as G,h as D,Q as E,b as O,H as R}from"./index-P9e6f5pO.js";import{E as B}from"./index-CdgZBgJS.js";import{r as m}from"./iframe-BkDlsCAP.js";import{c as y}from"./createLucideIcon-DAmjF4QE.js";import{S as U}from"./settings-DV2OQ1-o.js";import"./index-QWo0TafW.js";import"./index-DeffF2QR.js";import{H as z}from"./index-DimfubNE.js";import"./index-BKtDPDeF.js";import"./index-Dh5ugEvd.js";import{L as V}from"./index-RhGk7Ec3.js";import"./index-CnCfSs24.js";import"./index-CtMBXFSn.js";import"./index-CQNU1u8j.js";import"./index-CL1Zaf3o.js";import{D as v}from"./index-BgiX4SHn.js";import{a as I,S as F}from"./index-CC4-6XaD.js";import"./index-7UqfzQey.js";import{g as Q}from"./index-6u4lpM7_.js";import{u as J}from"./useErrorModal-CZ-toeB0.js";import{G as K}from"./index-i3tSlb19.js";import"./preload-helper-PPVm8Dsz.js";import"./index-CopGqJT4.js";import"./Combination-BFEupeOy.js";import"./index-DgOh1JBi.js";import"./index-BxahsN8O.js";import"./x-BCqU_SQv.js";import"./chunk-JMJ3UQ3L-cMYYwAMf.js";import"./user-Fzqz4bxW.js";import"./index-DHWgz4mK.js";import"./chevron-down-CvXt-Trb.js";import"./check-CWKmyp42.js";const Y=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],Z=y("chart-column",Y);const W=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]],X=y("clipboard-list",W);const ee=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16.5 12",key:"1aq6pp"}]],te=y("clock-3",ee);const oe=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]],re=y("house",oe),j=m.createContext(null);function k({value:t,children:r}){return a.jsx(j.Provider,{value:t,children:r})}function ae(){const t=m.useContext(j);if(!t)throw new Error("GroupLayoutProvider が見つかりません。グループ配下のレイアウトでラップしてください。");return t}k.__docgenInfo={description:"",methods:[],displayName:"GroupLayoutProvider",props:{value:{required:!0,tsType:{name:"GroupLayoutValue"},description:""},children:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""}}};const se=(t,r,o)=>{const e=`/groups/${t}`,s={groupName:r};return[{label:"ホーム",to:e,icon:re,isActive:o===e,state:s},{label:"レポート",to:`${e}/reports`,icon:Z,isActive:o===`${e}/reports`,state:s},{label:"家事",to:`${e}/chores`,icon:X,isActive:o===`${e}/chores`,state:s},{label:"設定",to:`${e}/settings`,icon:U,isActive:o===`${e}/settings`,state:s}]},ne="_floatingAction_jf9xz_1",ie={floatingAction:ne},ce="_form_1tqiv_1",ue="_section_1tqiv_7",de="_sectionHeader_1tqiv_13",me="_sectionIcon_1tqiv_22",c={form:ce,section:ue,sectionHeader:de,sectionIcon:me},g=t=>`${String(t)}時`,w=t=>{const o=new Intl.DateTimeFormat("ja-JP",{timeZone:"Asia/Tokyo",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",hour12:!1}).formatToParts(t),e=s=>o.find(n=>n.type===s)?.value??"";return{year:e("year"),month:e("month"),day:e("day"),hour:e("hour")}},le=Array.from({length:24},(t,r)=>{const o=g(r),e=g((r+1)%24),s=`${o}〜${e}`;return{value:s,label:s}}),C=()=>{const t=new Date,r=w(t).hour,o=Number(r),e=Number.isNaN(o)?t.getHours():o,s=g(e),n=g((e+1)%24);return`${s}〜${n}`},pe=t=>{const r=/^(\d{1,2})時〜/.exec(t);if(!r)return null;const o=Number(r[1]);return Number.isNaN(o)||o<0||o>23?null:o};function M({open:t,onOpenChange:r,choreOptions:o,choresLoading:e=!1,isSubmitting:s=!1,onSubmit:n}){const[u,l]=m.useState(void 0),[p,i]=m.useState(C),f=!u||s,x=w(new Date),P=`本日 ${`${x.month}月${x.day}日`}の討伐として記録されます！`,$=()=>{l(void 0),i(C())},b=d=>{d||$(),r(d)},S=async()=>{if(!u||s)return;const d=pe(p);if(d!==null)try{await n({choreId:Number(u),startHour:d}),b(!1)}catch{}};return a.jsx(z,{open:t,onOpenChange:b,title:"家事を討伐する",headerIcon:a.jsx(F,{size:"sm","aria-hidden":!0}),primaryActionLabel:"討伐完了",secondaryActionLabel:"キャンセル",primaryActionDisabled:f,onPrimaryAction:()=>{S()},onSecondaryAction:()=>{b(!1)},children:a.jsxs("div",{className:c.form,children:[a.jsxs("section",{className:c.section,"aria-labelledby":"chore-select-heading",children:[a.jsxs("div",{id:"chore-select-heading",className:c.sectionHeader,children:[a.jsx(I,{className:c.sectionIcon,"aria-hidden":!0}),a.jsx("span",{children:"討伐する家事を選択"})]}),a.jsx(v,{placeholder:"家事を選択しよう！",emptyMessage:e?a.jsx(V,{size:"md",ariaLabel:"家事を読み込み中"}):"討伐する家事がありません、、！",options:o,value:u,onChange:l,disabled:e})]}),a.jsxs("section",{className:c.section,"aria-labelledby":"battle-time-heading",children:[a.jsxs("div",{id:"battle-time-heading",className:c.sectionHeader,children:[a.jsx(te,{className:c.sectionIcon,"aria-hidden":!0}),a.jsx("span",{children:"討伐時刻"})]}),a.jsx(v,{options:le,value:p,onChange:i,helperText:P,helperTextVariant:"notice"})]})]})})}M.__docgenInfo={description:"",methods:[],displayName:"ChoreBeatingModal",props:{open:{required:!0,tsType:{name:"boolean"},description:""},onOpenChange:{required:!0,tsType:{name:"signature",type:"function",raw:"(open: boolean) => void",signature:{arguments:[{type:{name:"boolean"},name:"open"}],return:{name:"void"}}},description:""},choreOptions:{required:!0,tsType:{name:"Array",elements:[{name:"DropdownOption"}],raw:"DropdownOption[]"},description:""},choresLoading:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},isSubmitting:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},onSubmit:{required:!0,tsType:{name:"signature",type:"function",raw:"(payload: { choreId: number; startHour: number }) => Promise<void>",signature:{arguments:[{type:{name:"signature",type:"object",raw:"{ choreId: number; startHour: number }",signature:{properties:[{key:"choreId",value:{name:"number",required:!0}},{key:"startHour",value:{name:"number",required:!0}}]}},name:"payload"}],return:{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}}},description:""}}};const he=t=>["groups",t,"chores"],ge=t=>{const r=t??"";return T({queryKey:he(r),queryFn:()=>A({groupId:r}),enabled:!!t})},ye=t=>{const o=new Intl.DateTimeFormat("ja-JP",{timeZone:"Asia/Tokyo",year:"numeric",month:"2-digit",day:"2-digit"}).formatToParts(t),e=s=>o.find(n=>n.type===s)?.value??"";return{year:e("year"),month:e("month"),day:e("day")}},fe=t=>{const{year:r,month:o,day:e}=ye(new Date),s=String(t).padStart(2,"0");return`${r}-${o}-${e}T${s}:00:00+09:00`},be=()=>{const{showError:t,closeError:r,getModalMessage:o}=J();return L({mutationFn:({groupId:e,choreId:s,startHour:n})=>q({groupId:e,chore_id:s,beated_at:fe(n)}),onSuccess:()=>{r()},onError:e=>{const s=e instanceof G?e.status:void 0,n=e instanceof Error&&e.message?e.message:"討伐記録の作成に失敗しました";t({title:"討伐エラー",message:s?o(s):n})}})};function H(){const{groupId:t}=ae(),[r,o]=m.useState(!1),{data:e,isLoading:s}=ge(t),{mutateAsync:n,isPending:u}=be(),l=[{timeLabel:"09:00",items:[{id:"beating-1",choreIconCode:"laundry",choreName:"洗濯",userName:"山田 太郎",userImageUrl:"https://placehold.co/96x96/png",likeCount:0,commentCount:0,userRoleLabel:"討伐者",messages:[{userName:"山田 太郎",userImageUrl:"https://placehold.co/64x64/png",mainMessage:"いつも助かってます！",describeMessage:"朝からありがとう！"},{userName:"佐藤 花子",userImageUrl:null,mainMessage:"助かったよ！",describeMessage:"これで夕飯の準備がスムーズ。"}]}]},{timeLabel:"10:00",items:[{id:"beating-2",choreIconCode:"dish-wash",choreName:"食器洗い",userName:"佐藤 花子",userImageUrl:null,likeCount:12,commentCount:3,userRoleLabel:"討伐者",messages:[{userName:"佐藤 花子",userImageUrl:null,mainMessage:"ナイス討伐！",describeMessage:"片付けが早く終わって助かったよ。"}]},{id:"beating-3",choreIconCode:"shopping",choreName:"買い物",userName:"田中 花子",userImageUrl:null,likeCount:4,commentCount:1,userRoleLabel:"討伐者",messages:[{userName:"田中 花子",userImageUrl:null,mainMessage:"ありがとう！",describeMessage:"おかげで夕飯の準備がスムーズでした。"}]}]}],p=e?.map(i=>({value:String(i.id),label:i.name,icon:a.jsx("span",{"aria-hidden":!0,children:Q(i.icon_code)})}))??[];return a.jsxs(a.Fragment,{children:[a.jsx(M,{open:r,onOpenChange:o,choreOptions:p,choresLoading:s,isSubmitting:u,onSubmit:async({choreId:i,startHour:f})=>{t&&await n({groupId:t,choreId:i,startHour:f})}}),a.jsx(K,{beatingGroups:l}),a.jsx("button",{type:"button",className:ie.floatingAction,"aria-label":"バトルを開く","aria-haspopup":"dialog",onClick:()=>{o(!0)},children:a.jsx(I,{size:30})})]})}H.__docgenInfo={description:"",methods:[],displayName:"GroupHomePage"};const _="group-1",N="永井家",xe={id:"user-1",name:"山田 花子",email:"hanako@example.com",image:null},ve=[{id:1,name:"食器洗い",icon_code:"dish-wash"},{id:2,name:"掃除",icon_code:"cleaning"},{id:3,name:"洗濯",icon_code:"laundry"}],tt={component:H,parameters:{layout:"fullscreen",msw:{handlers:[D.get(/\/api\/groups\/[^/]+\/chores$/,()=>R.json(ve))]}},decorators:[t=>{const r=new E({defaultOptions:{queries:{refetchOnWindowFocus:!1}}});return a.jsx(O,{client:r,children:a.jsx(B,{children:a.jsx(k,{value:{groupId:_,groupName:N,navItems:se(_,N),currentUser:xe},children:a.jsx(t,{})})})})}]},h={};h.parameters={...h.parameters,docs:{...h.parameters?.docs,source:{originalSource:"{}",...h.parameters?.docs?.source}}};const ot=["Default"];export{h as Default,ot as __namedExportsOrder,tt as default};
