import{j as e}from"./jsx-runtime-u17CrQMm.js";import{r as p}from"./iframe-BRNvH2Gd.js";import{g as w,G as A}from"./index-BDim0KBv.js";import{U as y}from"./index-BgH8RbQ3.js";import{H as U}from"./index-BcZKTfBC.js";import{C as H}from"./index-Bz1DvCpl.js";import{L as P}from"./index-Br_3CpnR.js";import{m as f,A as V}from"./index-Dxe1s2Wz.js";import{c as G}from"./createLucideIcon-pQLKViWr.js";import{u as j}from"./QueryClientProvider-BUKZlcAE.js";import{u as x,b as O,A as N,d as D}from"./index-QRox4G42.js";import{u as b}from"./useErrorModal-CF-LR51w.js";const Q=[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}],["path",{d:"M14.8 7.5a1.84 1.84 0 0 0-2.6 0l-.2.3-.3-.3a1.84 1.84 0 1 0-2.4 2.8L12 13l2.7-2.7c.9-.9.8-2.1.1-2.8",key:"1blaws"}]],K=G("message-square-heart",Q),Ae=s=>["groups",s,"chores"],k=(s,r)=>["groups",s,"beatings",r],Y="_gratitudeList_1f8zk_1",$="_gratitudeAccordion_1f8zk_7",F="_gratitudeSummaryIcon_1f8zk_13",J="_gratitudeSummary_1f8zk_13",W="_gratitudeSummaryText_1f8zk_38",X="_gratitudeExtraList_1f8zk_43",Z="_gratitudeItem_1f8zk_49",ee="_gratitudeHeader_1f8zk_60",se="_gratitudeBadge_1f8zk_66",te="_gratitudeName_1f8zk_84",ae="_gratitudeMain_1f8zk_91",re="_gratitudeDescribe_1f8zk_99",o={gratitudeList:Y,gratitudeAccordion:$,gratitudeSummaryIcon:F,gratitudeSummary:J,gratitudeSummaryText:W,gratitudeExtraList:X,gratitudeItem:Z,gratitudeHeader:ee,gratitudeBadge:se,gratitudeName:te,gratitudeMain:ae,gratitudeDescribe:re};function h({message:s}){return e.jsxs("div",{className:o.gratitudeItem,children:[e.jsxs("div",{className:o.gratitudeHeader,children:[e.jsx(y,{name:s.userName,imageUrl:s.userImageUrl,size:"sm",tone:"orange",badge:e.jsx("span",{className:o.gratitudeBadge,"aria-hidden":!0,children:e.jsx(U,{size:"sm"})})}),e.jsx("p",{className:o.gratitudeName,children:s.userName})]}),e.jsx("p",{className:o.gratitudeMain,children:s.mainMessage}),s.describeMessage?e.jsx("p",{className:o.gratitudeDescribe,children:s.describeMessage}):null]})}function v({messages:s=[]}){if(s.length===0)return null;const r=s[0],n=s.slice(1);return e.jsxs("div",{className:o.gratitudeList,"aria-label":"感謝メッセージ",children:[e.jsx(h,{message:r}),n.length>0?e.jsxs("details",{className:o.gratitudeAccordion,children:[e.jsxs("summary",{className:o.gratitudeSummary,children:[e.jsx("span",{className:o.gratitudeSummaryIcon,"aria-hidden":!0,children:e.jsx(H,{size:16})}),e.jsxs("span",{className:o.gratitudeSummaryText,children:["他",n.length,"件の感謝を見る"]})]}),e.jsx("div",{className:o.gratitudeExtraList,children:n.map(c=>e.jsx(h,{message:c},c.id))})]}):null]})}v.__docgenInfo={description:"",methods:[],displayName:"BeatingMessages",props:{messages:{required:!1,tsType:{name:"unknown"},description:"",defaultValue:{value:"[]",computed:!1}}}};const ne="_button_vjy7c_1",ie="_icon_vjy7c_22",oe="_count_vjy7c_28",ce="_thanksRibbon_vjy7c_33",l={button:ne,icon:ie,count:oe,thanksRibbon:ce},ue={solid:{fill:"currentColor",stroke:"currentColor"},outline:{fill:"none",stroke:"currentColor"}};function M({messagedByMe:s,commentCount:r,onClick:n}){const t=ue[s?"solid":"outline"],[a,u]=p.useState(!1),[d,m]=p.useState(0);return e.jsxs(f.button,{type:"button",className:l.button,"aria-label":"メッセージを送る","aria-pressed":s,whileTap:{scale:.8},onClick:()=>{if(s){m(g=>g+1),u(!0);return}n()},children:[e.jsx("span",{className:l.icon,"aria-hidden":!0,children:e.jsx(K,{size:20,...t})}),r>0?e.jsx("span",{className:l.count,children:r}):null,e.jsx(V,{children:a?e.jsx(f.span,{className:l.thanksRibbon,"aria-hidden":!0,initial:{opacity:0,y:8,scale:.96},animate:{opacity:[0,1,1,0],y:[8,0,-4,-8],scale:[.96,1.3,1.3,.98]},transition:{duration:1.4,ease:"easeOut"},onAnimationComplete:()=>{u(!1)},children:"いつも感謝をありがとう"},d):null})]})}M.__docgenInfo={description:"",methods:[],displayName:"MessageReaction",props:{messagedByMe:{required:!0,tsType:{name:"boolean"},description:""},commentCount:{required:!0,tsType:{name:"number"},description:""},onClick:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""}}};const de=()=>{const s=j(),{showError:r,closeError:n,getModalMessage:c}=b();return x({mutationFn:({groupId:t,beatingId:a})=>O({groupId:t,beatingId:a}),onSuccess:async(t,a)=>{await s.invalidateQueries({queryKey:k(a.groupId,a.date)}),n()},onError:t=>{const a=t instanceof N?t.status:void 0,u=t instanceof Error&&t.message?t.message:"いいねの送信に失敗しました";r({title:"いいねエラー",message:a?c(a):u})}})},le=()=>{const s=j(),{showError:r,closeError:n,getModalMessage:c}=b();return x({mutationFn:({groupId:t,beatingId:a,mainMessage:u,descriptionMessage:d})=>D({groupId:t,beatingId:a,main_message:u,description_message:d.length>0?d:null}),onSuccess:async(t,a)=>{await s.invalidateQueries({queryKey:k(a.groupId,a.date)}),n()},onError:t=>{const a=t instanceof N?t.status:void 0,u=t instanceof Error&&t.message?t.message:"感謝メッセージの送信に失敗しました";r({title:"感謝メッセージ投稿エラー",message:a?c(a):u})}})},me="_card_1mjof_1",ge="_header_1mjof_14",pe="_choreIcon_1mjof_20",_e="_headerBody_1mjof_31",fe="_choreName_1mjof_38",he="_reactions_1mjof_45",ye="_divider_1mjof_53",je="_footer_1mjof_59",xe="_user_1mjof_65",Ne="_userText_1mjof_71",be="_userName_1mjof_77",ke="_userRole_1mjof_84",i={card:me,header:ge,choreIcon:pe,headerBody:_e,choreName:fe,reactions:he,divider:ye,footer:je,user:xe,userText:Ne,userName:be,userRole:ke};function ve({groupId:s,beatingId:r,date:n,choreIconCode:c,choreName:t,userName:a,userImageUrl:u,likeCount:d=0,likedByMe:m=!1,messagedByMe:g=!1,commentCount:T=0,userRoleLabel:I="討伐者",messages:C=[]}){const{mutate:S,isPending:q}=de(),{mutateAsync:E,isPending:B}=le(),[R,_]=p.useState(!1);return e.jsxs("article",{className:i.card,"aria-label":`${a}が${t}を討伐`,children:[e.jsxs("div",{className:i.header,children:[e.jsx("div",{className:i.choreIcon,"aria-hidden":!0,children:w(c)}),e.jsxs("div",{className:i.headerBody,children:[e.jsx("p",{className:i.choreName,children:t}),e.jsxs("div",{className:i.reactions,children:[e.jsx(P,{likedByMe:m,likeCount:d,isLiking:q,onLike:()=>{S({groupId:s,beatingId:r,date:n})}}),e.jsx(M,{messagedByMe:g,commentCount:T,onClick:()=>{_(!0)}})]})]})]}),e.jsx(v,{messages:C}),e.jsx("div",{className:i.divider,"aria-hidden":!0}),e.jsx("div",{className:i.footer,children:e.jsxs("div",{className:i.user,children:[e.jsx(y,{name:a,imageUrl:u,size:"md",tone:"purple"}),e.jsxs("div",{className:i.userText,children:[e.jsx("p",{className:i.userName,children:a}),e.jsx("p",{className:i.userRole,children:I})]})]})}),e.jsx(A,{open:R,onOpenChange:_,choreIconCode:c,choreName:t,userName:a,isSubmitting:B,onSubmit:async({mainMessage:z,descriptionMessage:L})=>{await E({groupId:s,beatingId:r,date:n,mainMessage:z,descriptionMessage:L})}})]})}ve.__docgenInfo={description:"",methods:[],displayName:"BeatingCard",props:{groupId:{required:!0,tsType:{name:"string"},description:""},beatingId:{required:!0,tsType:{name:"number"},description:""},date:{required:!0,tsType:{name:"string"},description:""},choreIconCode:{required:!0,tsType:{name:"unknown"},description:""},choreName:{required:!0,tsType:{name:"string"},description:""},userName:{required:!0,tsType:{name:"string"},description:""},userImageUrl:{required:!1,tsType:{name:"union",raw:"string | null",elements:[{name:"string"},{name:"null"}]},description:""},likeCount:{required:!1,tsType:{name:"number"},description:"",defaultValue:{value:"0",computed:!1}},likedByMe:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},messagedByMe:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},commentCount:{required:!1,tsType:{name:"number"},description:"",defaultValue:{value:"0",computed:!1}},userRoleLabel:{required:!1,tsType:{name:"string"},description:"",defaultValue:{value:'"討伐者"',computed:!1}},messages:{required:!1,tsType:{name:"unknown"},description:"",defaultValue:{value:"[]",computed:!1}}}};export{ve as B,Ae as G,k as a};
